<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="2113.65">
  <style type="text/css">
    p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica}
    p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica; min-height: 14.0px}
    span.s1 {font: 12.0px 'PingFang HK'}
    span.s2 {font: 12.0px 'Apple Color Emoji'}
  </style>
</head>
<body>
<p class="p1">&lt;!DOCTYPE html&gt;</p>
<p class="p1">&lt;html lang="zh-TW"&gt;</p>
<p class="p1">&lt;head&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;meta charset="UTF-8"&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;title&gt;<span class="s1">個人財務追蹤器</span>&lt;/title&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;script src="https://cdn.tailwindcss.com"&gt;&lt;/script&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;link href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.0.0/css/all.css" rel="stylesheet"&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;script&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>tailwind.config = {</p>
<p class="p1"><span class="Apple-converted-space">            </span>darkMode: 'class',</p>
<p class="p1"><span class="Apple-converted-space">            </span>theme: {</p>
<p class="p1"><span class="Apple-converted-space">                </span>extend: {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>colors: {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>primary: '#5D5CDE',</p>
<p class="p1"><span class="Apple-converted-space">                        </span>'primary-dark': '#4645B2',</p>
<p class="p1"><span class="Apple-converted-space">                        </span>'primary-light': '#7877E6',</p>
<p class="p1"><span class="Apple-converted-space">                    </span>}</p>
<p class="p1"><span class="Apple-converted-space">                </span>}</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;/script&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;style&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>.emoji-btn {</p>
<p class="p1"><span class="Apple-converted-space">            </span>transition: transform 0.2s;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>.emoji-btn:hover {</p>
<p class="p1"><span class="Apple-converted-space">            </span>transform: scale(1.1);</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>.slide-enter {</p>
<p class="p1"><span class="Apple-converted-space">            </span>animation: slideIn 0.3s ease forwards;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>@keyframes slideIn {</p>
<p class="p1"><span class="Apple-converted-space">            </span>from {</p>
<p class="p1"><span class="Apple-converted-space">                </span>transform: translateY(20px);</p>
<p class="p1"><span class="Apple-converted-space">                </span>opacity: 0;</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p1"><span class="Apple-converted-space">            </span>to {</p>
<p class="p1"><span class="Apple-converted-space">                </span>transform: translateY(0);</p>
<p class="p1"><span class="Apple-converted-space">                </span>opacity: 1;</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>.modal {</p>
<p class="p1"><span class="Apple-converted-space">            </span>display: none;</p>
<p class="p1"><span class="Apple-converted-space">            </span>position: fixed;</p>
<p class="p1"><span class="Apple-converted-space">            </span>z-index: 1000;</p>
<p class="p1"><span class="Apple-converted-space">            </span>left: 0;</p>
<p class="p1"><span class="Apple-converted-space">            </span>top: 0;</p>
<p class="p1"><span class="Apple-converted-space">            </span>width: 100%;</p>
<p class="p1"><span class="Apple-converted-space">            </span>height: 100%;</p>
<p class="p1"><span class="Apple-converted-space">            </span>overflow: auto;</p>
<p class="p1"><span class="Apple-converted-space">            </span>background-color: rgba(0,0,0,0.5);</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>.modal-content {</p>
<p class="p1"><span class="Apple-converted-space">            </span>background-color: #fefefe;</p>
<p class="p1"><span class="Apple-converted-space">            </span>margin: 15% auto;</p>
<p class="p1"><span class="Apple-converted-space">            </span>padding: 20px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border-radius: 8px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>width: 90%;</p>
<p class="p1"><span class="Apple-converted-space">            </span>max-width: 500px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>position: relative;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>.close {</p>
<p class="p1"><span class="Apple-converted-space">            </span>position: absolute;</p>
<p class="p1"><span class="Apple-converted-space">            </span>top: 10px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>right: 15px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>color: #aaa;</p>
<p class="p1"><span class="Apple-converted-space">            </span>font-size: 28px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>font-weight: bold;</p>
<p class="p1"><span class="Apple-converted-space">            </span>cursor: pointer;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>.tab-content {</p>
<p class="p1"><span class="Apple-converted-space">            </span>display: none;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>.tab-content.active {</p>
<p class="p1"><span class="Apple-converted-space">            </span>display: block;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>.dark .bg-white {</p>
<p class="p1"><span class="Apple-converted-space">            </span>background-color: #222;</p>
<p class="p1"><span class="Apple-converted-space">            </span>color: #fff;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>.dark .bg-gray-50 {</p>
<p class="p1"><span class="Apple-converted-space">            </span>background-color: #181818;</p>
<p class="p1"><span class="Apple-converted-space">            </span>color: #fff;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>.dark .bg-gray-100 {</p>
<p class="p1"><span class="Apple-converted-space">            </span>background-color: #2a2a2a;</p>
<p class="p1"><span class="Apple-converted-space">            </span>color: #fff;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>.dark .text-gray-800 {</p>
<p class="p1"><span class="Apple-converted-space">            </span>color: #eee;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>.dark .text-gray-700 {</p>
<p class="p1"><span class="Apple-converted-space">            </span>color: #ddd;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>.dark .text-gray-600 {</p>
<p class="p1"><span class="Apple-converted-space">            </span>color: #ccc;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>.dark .border-gray-200 {</p>
<p class="p1"><span class="Apple-converted-space">            </span>border-color: #444;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>.dark .modal-content {</p>
<p class="p1"><span class="Apple-converted-space">            </span>background-color: #222;</p>
<p class="p1"><span class="Apple-converted-space">            </span>color: #fff;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>.dark select, .dark input, .dark textarea {</p>
<p class="p1"><span class="Apple-converted-space">            </span>background-color: #333;</p>
<p class="p1"><span class="Apple-converted-space">            </span>color: #fff;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border-color: #555;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>.notification {</p>
<p class="p1"><span class="Apple-converted-space">            </span>position: fixed;</p>
<p class="p1"><span class="Apple-converted-space">            </span>top: 20px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>right: 20px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>max-width: 300px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>background-color: #fff;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border-radius: 8px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);</p>
<p class="p1"><span class="Apple-converted-space">            </span>z-index: 1000;</p>
<p class="p1"><span class="Apple-converted-space">            </span>overflow: hidden;</p>
<p class="p1"><span class="Apple-converted-space">            </span>display: none;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>.dark .notification {</p>
<p class="p1"><span class="Apple-converted-space">            </span>background-color: #333;</p>
<p class="p1"><span class="Apple-converted-space">            </span>color: #fff;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>/* Import/Export modal styling */</p>
<p class="p1"><span class="Apple-converted-space">        </span>.import-export-buttons {</p>
<p class="p1"><span class="Apple-converted-space">            </span>display: flex;</p>
<p class="p1"><span class="Apple-converted-space">            </span>gap: 10px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>margin-top: 20px;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>.import-export-buttons button {</p>
<p class="p1"><span class="Apple-converted-space">            </span>flex: 1;</p>
<p class="p1"><span class="Apple-converted-space">            </span>padding: 10px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border-radius: 8px;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>#exportDataArea {</p>
<p class="p1"><span class="Apple-converted-space">            </span>width: 100%;</p>
<p class="p1"><span class="Apple-converted-space">            </span>height: 150px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>margin-top: 10px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border-radius: 8px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>padding: 10px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>resize: none;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>#importDataArea {</p>
<p class="p1"><span class="Apple-converted-space">            </span>width: 100%;</p>
<p class="p1"><span class="Apple-converted-space">            </span>height: 150px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>margin-top: 10px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>margin-bottom: 15px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border-radius: 8px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>padding: 10px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>resize: none;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;/style&gt;</p>
<p class="p1">&lt;/head&gt;</p>
<p class="p1">&lt;body class="bg-gray-50 min-h-screen"&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;div class="container mx-auto px-4 py-8 max-w-4xl"&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;!-- Header --&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;header class="mb-6"&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div class="flex justify-between items-center"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;h1 class="text-3xl font-bold text-primary"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;span class="mr-2"&gt;<span class="s2">💰</span>&lt;/span&gt;<span class="s1">個人財務追蹤器</span></p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/h1&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div class="flex space-x-2"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;!-- New Day Button --&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;button id="newDayBtn" class="bg-green-500 text-white px-4 py-2 rounded-md hover:bg-green-600 transition"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;span class="mr-1"&gt;<span class="s2">🌅</span>&lt;/span&gt;<span class="s1">開啟新的一天</span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;!-- Import/Export Button --&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;button id="importExportBtn" class="bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600 transition"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;span class="mr-1"&gt;<span class="s2">💾</span>&lt;/span&gt;<span class="s1">匯入</span>/<span class="s1">匯出</span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;!-- Balance Summary --&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div class="mt-4 grid grid-cols-1 md:grid-cols-3 gap-4"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div class="bg-white p-4 rounded-lg shadow slide-enter border-l-4 border-blue-500"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div class="text-gray-600"&gt;<span class="s1">總資產</span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div class="text-2xl font-bold text-blue-600"&gt;$ &lt;span id="totalBalance"&gt;0.00&lt;/span&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div class="bg-white p-4 rounded-lg shadow slide-enter border-l-4 border-green-500"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div class="text-gray-600"&gt;<span class="s1">今日收入</span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div class="text-2xl font-bold text-green-600"&gt;$ &lt;span id="todayIncome"&gt;0.00&lt;/span&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div class="bg-white p-4 rounded-lg shadow slide-enter border-l-4 border-red-500"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div class="text-gray-600"&gt;<span class="s1">今日支出</span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div class="text-2xl font-bold text-red-600"&gt;$ &lt;span id="todayExpense"&gt;0.00&lt;/span&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/header&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;!-- Navigation Tabs --&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;div class="mb-6 border-b border-gray-200"&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;ul class="flex flex-wrap -mb-px" id="tabsContainer"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;li class="mr-2"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;button data-tab="dashboard" class="tab-btn inline-block py-2 px-4 border-b-2 font-medium text-primary border-primary"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;span class="mr-1"&gt;<span class="s2">📊</span>&lt;/span&gt;<span class="s1">儀表板</span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/li&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;li class="mr-2"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;button data-tab="accounts" class="tab-btn inline-block py-2 px-4 border-b-2 font-medium text-gray-500 hover:text-gray-700 border-transparent"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;span class="mr-1"&gt;<span class="s2">💳</span>&lt;/span&gt;<span class="s1">戶口管理</span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/li&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;li class="mr-2"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;button data-tab="transactions" class="tab-btn inline-block py-2 px-4 border-b-2 font-medium text-gray-500 hover:text-gray-700 border-transparent"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;span class="mr-1"&gt;<span class="s2">📝</span>&lt;/span&gt;<span class="s1">記賬</span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/li&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;li class="mr-2"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;button data-tab="budget" class="tab-btn inline-block py-2 px-4 border-b-2 font-medium text-gray-500 hover:text-gray-700 border-transparent"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;span class="mr-1"&gt;<span class="s2">⚙️</span>&lt;/span&gt;<span class="s1">預算設定</span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/li&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;li class="mr-2"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;button data-tab="stats" class="tab-btn inline-block py-2 px-4 border-b-2 font-medium text-gray-500 hover:text-gray-700 border-transparent"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;span class="mr-1"&gt;<span class="s2">📈</span>&lt;/span&gt;<span class="s1">統計分析</span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/li&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/ul&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;!-- Main Content --&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;main&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;!-- Dashboard --&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div id="dashboard" class="tab-content active slide-enter"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div class="mb-8"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;h2 class="text-xl font-bold mb-4 text-gray-800"&gt;&lt;span class="mr-2"&gt;<span class="s2">📅</span>&lt;/span&gt;<span class="s1">今日交易</span>&lt;/h2&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div id="todayTransactionsEmpty" class="bg-white p-4 rounded-lg shadow text-center text-gray-500"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span><span class="s1">今日尚無交易記錄</span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div id="todayTransactionsTable" class="bg-white rounded-lg shadow overflow-hidden" style="display: none;"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;table class="min-w-full divide-y divide-gray-200"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;thead class="bg-gray-50"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;tr&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"&gt;<span class="s1">類型</span>&lt;/th&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"&gt;<span class="s1">戶口</span>&lt;/th&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"&gt;<span class="s1">類別</span>&lt;/th&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"&gt;<span class="s1">金額</span>&lt;/th&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"&gt;<span class="s1">備註</span>&lt;/th&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;/tr&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/thead&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;tbody id="todayTransactionsList" class="bg-white divide-y divide-gray-200"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;!-- Today transactions will be inserted here --&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/tbody&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/table&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div class="grid grid-cols-1 md:grid-cols-2 gap-8"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;!-- Budget Status --&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;h2 class="text-xl font-bold mb-4 text-gray-800"&gt;&lt;span class="mr-2"&gt;<span class="s2">📊</span>&lt;/span&gt;<span class="s1">預算狀態</span>&lt;/h2&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div id="noBudget" class="bg-white p-6 rounded-lg shadow text-center"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;p class="text-gray-500 mb-4"&gt;<span class="s1">尚未設定預算</span>&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;button id="goBudgetBtn" class="bg-primary text-white px-4 py-2 rounded-md hover:bg-primary-dark transition"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span><span class="s1">設定預算</span></p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div id="budgetStatus" class="bg-white p-6 rounded-lg shadow" style="display: none;"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div class="mb-2 flex justify-between"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;span class="text-gray-600"&gt;<span class="s1">預算週期</span>:&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;span id="budgetCycleText"&gt;&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div class="mb-2 flex justify-between"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;span class="text-gray-600"&gt;<span class="s1">總預算</span>:&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;span class="font-medium"&gt;$&lt;span id="budgetAmount"&gt;&lt;/span&gt;&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div class="mb-2 flex justify-between"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;span class="text-gray-600"&gt;<span class="s1">已使用</span>:&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;span class="font-medium"&gt;$&lt;span id="budgetUsed"&gt;&lt;/span&gt;&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div class="mb-2 flex justify-between"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;span class="text-gray-600"&gt;<span class="s1">剩餘預算</span>:&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;span id="budgetRemaining" class="font-medium"&gt;&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div class="mt-4"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;div class="w-full bg-gray-200 rounded-full h-2.5"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;div id="budgetBar" class="h-2.5 rounded-full bg-primary"&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;div id="budgetPercentage" class="text-right text-sm mt-1 text-gray-500"&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;!-- Recent Transactions --&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;h2 class="text-xl font-bold mb-4 text-gray-800"&gt;&lt;span class="mr-2"&gt;<span class="s2">🕒</span>&lt;/span&gt;<span class="s1">近期交易</span>&lt;/h2&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div id="noTransactions" class="bg-white p-4 rounded-lg shadow text-center text-gray-500"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span><span class="s1">尚無交易記錄</span></p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div id="recentTransactions" class="bg-white rounded-lg shadow overflow-hidden" style="display: none;"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;ul id="recentTransactionsList" class="divide-y divide-gray-200"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;!-- Recent transactions will be inserted here --&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/ul&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div class="p-4 border-t border-gray-200"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;button id="viewAllTransactionsBtn" class="text-primary hover:text-primary-dark text-sm font-medium flex items-center"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span><span class="s1">查看全部交易</span></p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;svg class="w-4 h-4 ml-1" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                        </span>&lt;path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"&gt;&lt;/path&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;/svg&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;!-- Accounts Management --&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div id="accounts" class="tab-content slide-enter"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div id="accountsGrid" class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-8"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;!-- Account cards will be inserted here --&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;!-- Transfer Money Between Accounts --&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div class="bg-white p-6 rounded-lg shadow mb-6"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;h3 class="text-lg font-bold mb-4"&gt;&lt;span class="mr-2"&gt;<span class="s2">🔄</span>&lt;/span&gt;<span class="s1">轉賬</span>&lt;/h3&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div class="grid grid-cols-1 md:grid-cols-3 gap-4"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;label class="block text-gray-700 mb-2"&gt;<span class="s1">從戶口</span>&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;select id="transferFrom" class="w-full p-2 border border-gray-300 rounded-md text-base"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;option value="" disabled selected&gt;<span class="s1">選擇戶口</span>&lt;/option&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;!-- From account options will be inserted here --&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/select&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;label class="block text-gray-700 mb-2"&gt;<span class="s1">至戶口</span>&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;select id="transferTo" class="w-full p-2 border border-gray-300 rounded-md text-base"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;option value="" disabled selected&gt;<span class="s1">選擇戶口</span>&lt;/option&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;!-- To account options will be inserted here --&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/select&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;label class="block text-gray-700 mb-2"&gt;<span class="s1">金額</span>&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;input type="number" id="transferAmount" placeholder="<span class="s1">輸入金額</span>" class="w-full p-2 border border-gray-300 rounded-md text-base"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div class="mt-4 flex justify-end"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;button id="transferBtn" class="bg-primary text-white px-4 py-2 rounded-md hover:bg-primary-dark transition"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span><span class="s1">確認轉賬</span></p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;!-- Transactions (Record Income/Expense) --&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div id="transactions" class="tab-content slide-enter"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div class="bg-white p-6 rounded-lg shadow"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;h2 class="text-xl font-bold mb-4"&gt;&lt;span class="mr-2"&gt;<span class="s2">📝</span>&lt;/span&gt;<span class="s1">記錄收入</span>/<span class="s1">支出</span>&lt;/h2&gt;</p>
<p class="p2"><span class="Apple-converted-space">                    </span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div class="mb-4"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div class="flex space-x-4"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;button id="incomeBtn" class="flex-1 py-2 px-4 rounded-md font-medium bg-gray-200 text-gray-700"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;span class="mr-2"&gt;<span class="s2">💹</span>&lt;/span&gt;<span class="s1">收入</span></p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;button id="expenseBtn" class="flex-1 py-2 px-4 rounded-md font-medium bg-red-500 text-white"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;span class="mr-2"&gt;<span class="s2">💸</span>&lt;/span&gt;<span class="s1">支出</span></p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div class="grid grid-cols-1 md:grid-cols-2 gap-4"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;label class="block text-gray-700 mb-2"&gt;<span class="s1">選擇戶口</span>&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;select id="transactionAccount" class="w-full p-2 border border-gray-300 rounded-md text-base"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;option value="" disabled selected&gt;<span class="s1">選擇戶口</span>&lt;/option&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;!-- Account options will be inserted here --&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/select&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</p>
<p class="p2"><span class="Apple-converted-space">                        </span></p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;label class="block text-gray-700 mb-2"&gt;<span class="s1">選擇類別</span>&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div class="flex gap-2"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;select id="transactionCategory" class="flex-1 p-2 border border-gray-300 rounded-md text-base"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;option value="" disabled selected&gt;<span class="s1">選擇類別</span>&lt;/option&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;!-- Category options will be inserted here --&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;/select&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;button id="addCategoryBtn" class="bg-gray-200 hover:bg-gray-300 text-gray-700 p-2 rounded-md"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;i class="fas fa-plus"&gt;&lt;/i&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</p>
<p class="p2"><span class="Apple-converted-space">                        </span></p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;label class="block text-gray-700 mb-2"&gt;<span class="s1">金額</span>&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;input type="number" id="transactionAmount" placeholder="<span class="s1">輸入金額</span>" class="w-full p-2 border border-gray-300 rounded-md text-base"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</p>
<p class="p2"><span class="Apple-converted-space">                        </span></p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;label class="block text-gray-700 mb-2"&gt;<span class="s1">日期</span>&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;input type="date" id="transactionDate" class="w-full p-2 border border-gray-300 rounded-md text-base"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</p>
<p class="p2"><span class="Apple-converted-space">                        </span></p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div class="md:col-span-2"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;label class="block text-gray-700 mb-2"&gt;<span class="s1">備註</span> (<span class="s1">可選</span>)&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;textarea id="transactionNote" placeholder="<span class="s1">輸入備註</span>" class="w-full p-2 border border-gray-300 rounded-md text-base" rows="2"&gt;&lt;/textarea&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</p>
<p class="p2"><span class="Apple-converted-space">                        </span></p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;!-- Quick Add Buttons --&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div class="md:col-span-2"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;label class="block text-gray-700 mb-2"&gt;<span class="s1">快速加入</span>&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div id="quickAmounts" class="flex flex-wrap gap-2"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;!-- Quick amount buttons will be inserted here --&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p2"><span class="Apple-converted-space">                    </span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div class="mt-6 flex justify-end"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;button id="saveTransactionBtn" class="bg-primary text-white px-6 py-2 rounded-md hover:bg-primary-dark transition"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;span class="mr-2"&gt;<span class="s2">✅</span>&lt;/span&gt;<span class="s1">保存</span></p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;!-- Budget Setting --&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div id="budget" class="tab-content slide-enter"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div class="bg-white p-6 rounded-lg shadow"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;h2 class="text-xl font-bold mb-4"&gt;&lt;span class="mr-2"&gt;<span class="s2">⚙️</span>&lt;/span&gt;<span class="s1">預算設定</span>&lt;/h2&gt;</p>
<p class="p2"><span class="Apple-converted-space">                    </span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div class="grid grid-cols-1 md:grid-cols-2 gap-6"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;label class="block text-gray-700 mb-2"&gt;<span class="s1">預算金額</span>&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;input type="number" id="budgetAmountInput" placeholder="<span class="s1">輸入預算金額</span>" class="w-full p-2 border border-gray-300 rounded-md text-base"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</p>
<p class="p2"><span class="Apple-converted-space">                        </span></p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;label class="block text-gray-700 mb-2"&gt;<span class="s1">重設週期</span>&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;select id="budgetCycle" class="w-full p-2 border border-gray-300 rounded-md text-base"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;option value="daily"&gt;<span class="s1">每日</span>&lt;/option&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;option value="weekly"&gt;<span class="s1">每週</span>&lt;/option&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;option value="monthly" selected&gt;<span class="s1">每月</span>&lt;/option&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/select&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</p>
<p class="p2"><span class="Apple-converted-space">                        </span></p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;label class="block text-gray-700 mb-2"&gt;<span class="s1">通知閾值</span> (%)&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;input type="number" id="budgetAlertThreshold" min="1" max="100" placeholder="<span class="s1">例如</span>: 80" value="80" class="w-full p-2 border border-gray-300 rounded-md text-base"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;p class="text-sm text-gray-500 mt-1"&gt;<span class="s1">當預算使用超過此百分比時發出通知</span>&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</p>
<p class="p2"><span class="Apple-converted-space">                        </span></p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;label class="block text-gray-700 mb-2"&gt;<span class="s1">重設日</span>&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;select id="budgetResetDay" class="w-full p-2 border border-gray-300 rounded-md text-base"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;!-- Reset day options will be inserted here --&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/select&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p2"><span class="Apple-converted-space">                    </span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div class="mt-6 flex justify-end"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;button id="saveBudgetBtn" class="bg-primary text-white px-6 py-2 rounded-md hover:bg-primary-dark transition"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;span class="mr-2"&gt;<span class="s2">✅</span>&lt;/span&gt;<span class="s1">保存設定</span></p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;!-- Statistics --&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div id="stats" class="tab-content slide-enter"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div class="mb-6"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;h2 class="text-xl font-bold mb-4"&gt;&lt;span class="mr-2"&gt;<span class="s2">🔍</span>&lt;/span&gt;<span class="s1">搜尋交易</span>&lt;/h2&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div class="bg-white p-4 rounded-lg shadow"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div class="grid grid-cols-1 md:grid-cols-3 gap-4"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;label class="block text-gray-700 mb-2"&gt;<span class="s1">日期範圍</span>&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;div class="grid grid-cols-2 gap-2"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;input type="date" id="searchStartDate" class="w-full p-2 border border-gray-300 rounded-md text-base"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;input type="date" id="searchEndDate" class="w-full p-2 border border-gray-300 rounded-md text-base"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/div&gt;</p>
<p class="p2"><span class="Apple-converted-space">                            </span></p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;label class="block text-gray-700 mb-2"&gt;<span class="s1">類型</span>&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;select id="searchType" class="w-full p-2 border border-gray-300 rounded-md text-base"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;option value=""&gt;<span class="s1">全部</span>&lt;/option&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;option value="income"&gt;<span class="s1">收入</span>&lt;/option&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;option value="expense"&gt;<span class="s1">支出</span>&lt;/option&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;/select&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/div&gt;</p>
<p class="p2"><span class="Apple-converted-space">                            </span></p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;label class="block text-gray-700 mb-2"&gt;<span class="s1">類別</span>&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;select id="searchCategory" class="w-full p-2 border border-gray-300 rounded-md text-base"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;option value=""&gt;<span class="s1">全部類別</span>&lt;/option&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;!-- All categories will be inserted here --&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;/select&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</p>
<p class="p2"><span class="Apple-converted-space">                        </span></p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div class="mt-4 flex justify-end"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;button id="searchBtn" class="bg-primary text-white px-4 py-2 rounded-md hover:bg-primary-dark transition"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;span class="mr-2"&gt;<span class="s2">🔍</span>&lt;/span&gt;<span class="s1">搜尋</span></p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;h2 class="text-xl font-bold mb-4"&gt;&lt;span class="mr-2"&gt;<span class="s2">📋</span>&lt;/span&gt;<span class="s1">交易記錄</span>&lt;/h2&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div id="noSearchResults" class="bg-white p-4 rounded-lg shadow text-center text-gray-500"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span><span class="s1">無符合條件的交易記錄</span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div id="searchResults" class="bg-white rounded-lg shadow overflow-hidden" style="display: none;"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;table class="min-w-full divide-y divide-gray-200"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;thead class="bg-gray-50"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;tr&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"&gt;<span class="s1">日期</span>&lt;/th&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"&gt;<span class="s1">類型</span>&lt;/th&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"&gt;<span class="s1">戶口</span>&lt;/th&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"&gt;<span class="s1">類別</span>&lt;/th&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"&gt;<span class="s1">金額</span>&lt;/th&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"&gt;<span class="s1">備註</span>&lt;/th&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"&gt;<span class="s1">操作</span>&lt;/th&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;/tr&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/thead&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;tbody id="searchResultsList" class="bg-white divide-y divide-gray-200"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;!-- Search results will be inserted here --&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/tbody&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/table&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/main&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;!-- Modals --&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;!-- New Account Modal --&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;div id="newAccountModal" class="modal"&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div class="modal-content"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;span class="close"&gt;&amp;times;&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;h3 class="text-xl font-bold mb-4"&gt;<span class="s1">新增戶口</span>&lt;/h3&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div class="mb-4"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;label class="block text-gray-700 mb-2"&gt;<span class="s1">戶口名稱</span>&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;input type="text" id="newAccountName" placeholder="<span class="s1">輸入戶口名稱</span>" class="w-full p-2 border border-gray-300 rounded-md text-base"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div class="mb-4"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;label class="block text-gray-700 mb-2"&gt;<span class="s1">初始餘額</span>&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;input type="number" id="newAccountBalance" placeholder="<span class="s1">輸入初始餘額</span>" class="w-full p-2 border border-gray-300 rounded-md text-base"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div class="mb-6"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;label class="block text-gray-700 mb-2"&gt;<span class="s1">選擇圖標</span>&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div id="accountIcons" class="grid grid-cols-5 gap-2"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;!-- Account icons will be inserted here --&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div class="flex justify-end"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;button id="addAccountBtn" class="bg-primary text-white px-4 py-2 rounded-md hover:bg-primary-dark transition"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span><span class="s1">新增戶口</span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;!-- New Category Modal --&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;div id="newCategoryModal" class="modal"&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div class="modal-content"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;span class="close"&gt;&amp;times;&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;h3 class="text-xl font-bold mb-4"&gt;<span class="s1">新增類別</span>&lt;/h3&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div class="mb-4"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;label class="block text-gray-700 mb-2"&gt;<span class="s1">類別名稱</span>&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;input type="text" id="newCategoryName" placeholder="<span class="s1">輸入類別名稱</span>" class="w-full p-2 border border-gray-300 rounded-md text-base"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div class="mb-4"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;label class="block text-gray-700 mb-2"&gt;<span class="s1">類型</span>&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div class="flex space-x-4"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;button id="newCategoryIncomeBtn" class="flex-1 py-2 px-4 rounded-md font-medium bg-gray-200 text-gray-700"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;span class="mr-2"&gt;<span class="s2">💹</span>&lt;/span&gt;<span class="s1">收入</span></p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;button id="newCategoryExpenseBtn" class="flex-1 py-2 px-4 rounded-md font-medium bg-red-500 text-white"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;span class="mr-2"&gt;<span class="s2">💸</span>&lt;/span&gt;<span class="s1">支出</span></p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div class="flex justify-end"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;button id="addCategoryConfirmBtn" class="bg-primary text-white px-4 py-2 rounded-md hover:bg-primary-dark transition"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span><span class="s1">新增類別</span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;!-- Import/Export Modal --&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;div id="importExportModal" class="modal"&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div class="modal-content"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;span class="close"&gt;&amp;times;&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;h3 class="text-xl font-bold mb-4"&gt;<span class="s1">數據匯入</span>/<span class="s1">匯出</span>&lt;/h3&gt;</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div class="mb-4"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;h4 class="font-medium mb-2"&gt;<span class="s1">匯出數據</span>&lt;/h4&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;p class="text-sm text-gray-600 mb-2"&gt;<span class="s1">複製下方文本以備份您的數據：</span>&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;textarea id="exportDataArea" class="border border-gray-300 bg-gray-50" readonly&gt;&lt;/textarea&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;button id="copyExportBtn" class="bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600 transition mt-2 w-full"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span><span class="s1">複製到剪貼板</span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div class="mt-6"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;h4 class="font-medium mb-2"&gt;<span class="s1">匯入數據</span>&lt;/h4&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;p class="text-sm text-gray-600 mb-2"&gt;<span class="s1">貼上之前匯出的數據：</span>&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;textarea id="importDataArea" class="border border-gray-300"&gt;&lt;/textarea&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;button id="importDataBtn" class="bg-green-500 text-white px-4 py-2 rounded-md hover:bg-green-600 transition w-full"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span><span class="s1">匯入數據</span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;!-- Notification --&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;div id="notification" class="notification"&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div class="p-4"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div class="text-center"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div id="notificationIcon" class="text-4xl mb-4"&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;h3 id="notificationTitle" class="text-lg font-bold mb-2"&gt;&lt;/h3&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;p id="notificationMessage" class="text-gray-600 mb-4"&gt;&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;script&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>// Global variables to store data</p>
<p class="p1"><span class="Apple-converted-space">        </span>let accounts = [];</p>
<p class="p1"><span class="Apple-converted-space">        </span>let categories = {</p>
<p class="p1"><span class="Apple-converted-space">            </span>income: [],</p>
<p class="p1"><span class="Apple-converted-space">            </span>expense: []</p>
<p class="p1"><span class="Apple-converted-space">        </span>};</p>
<p class="p1"><span class="Apple-converted-space">        </span>let transactions = [];</p>
<p class="p1"><span class="Apple-converted-space">        </span>let budget = {</p>
<p class="p1"><span class="Apple-converted-space">            </span>amount: 0,</p>
<p class="p1"><span class="Apple-converted-space">            </span>cycle: 'monthly',</p>
<p class="p1"><span class="Apple-converted-space">            </span>resetDay: 1,</p>
<p class="p1"><span class="Apple-converted-space">            </span>alertThreshold: 80,</p>
<p class="p1"><span class="Apple-converted-space">            </span>lastReset: null</p>
<p class="p1"><span class="Apple-converted-space">        </span>};</p>
<p class="p1"><span class="Apple-converted-space">        </span>let newDayStatus = {</p>
<p class="p1"><span class="Apple-converted-space">            </span>active: false,</p>
<p class="p1"><span class="Apple-converted-space">            </span>lastActivated: null</p>
<p class="p1"><span class="Apple-converted-space">        </span>};</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>// Selected values</p>
<p class="p1"><span class="Apple-converted-space">        </span>let selectedIcon = '<span class="s2">💳</span>';</p>
<p class="p1"><span class="Apple-converted-space">        </span>let selectedCategoryType = 'expense';</p>
<p class="p1"><span class="Apple-converted-space">        </span>let transactionType = 'expense';</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>// Check if localStorage is available</p>
<p class="p1"><span class="Apple-converted-space">        </span>let hasLocalStorage = false;</p>
<p class="p1"><span class="Apple-converted-space">        </span>try {</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (typeof localStorage !== 'undefined') {</p>
<p class="p1"><span class="Apple-converted-space">                </span>localStorage.setItem('test', 'test');</p>
<p class="p1"><span class="Apple-converted-space">                </span>localStorage.removeItem('test');</p>
<p class="p1"><span class="Apple-converted-space">                </span>hasLocalStorage = true;</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>} catch (e) {</p>
<p class="p1"><span class="Apple-converted-space">            </span>hasLocalStorage = false;</p>
<p class="p1"><span class="Apple-converted-space">            </span>console.log('localStorage not available:', e);</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>// DOM Elements</p>
<p class="p1"><span class="Apple-converted-space">        </span>const tabButtons = document.querySelectorAll('.tab-btn');</p>
<p class="p1"><span class="Apple-converted-space">        </span>const tabContents = document.querySelectorAll('.tab-content');</p>
<p class="p1"><span class="Apple-converted-space">        </span>const newAccountModal = document.getElementById('newAccountModal');</p>
<p class="p1"><span class="Apple-converted-space">        </span>const newCategoryModal = document.getElementById('newCategoryModal');</p>
<p class="p1"><span class="Apple-converted-space">        </span>const importExportModal = document.getElementById('importExportModal');</p>
<p class="p1"><span class="Apple-converted-space">        </span>const notification = document.getElementById('notification');</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>// Initialize the app when DOM is loaded</p>
<p class="p1"><span class="Apple-converted-space">        </span>document.addEventListener('DOMContentLoaded', function() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>// Initialize the app</p>
<p class="p1"><span class="Apple-converted-space">            </span>initApp();</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Setup event listeners</p>
<p class="p1"><span class="Apple-converted-space">            </span>setupEventListeners();</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Check for dark mode</p>
<p class="p1"><span class="Apple-converted-space">            </span>checkDarkMode();</p>
<p class="p1"><span class="Apple-converted-space">        </span>});</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>// Initialize the app</p>
<p class="p1"><span class="Apple-converted-space">        </span>function initApp() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>// Load data from localStorage if available</p>
<p class="p1"><span class="Apple-converted-space">            </span>loadData();</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Set default transaction date</p>
<p class="p1"><span class="Apple-converted-space">            </span>document.getElementById('transactionDate').value = getTodayFormatted();</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Set default search dates (1 month range)</p>
<p class="p1"><span class="Apple-converted-space">            </span>const today = new Date();</p>
<p class="p1"><span class="Apple-converted-space">            </span>const monthAgo = new Date();</p>
<p class="p1"><span class="Apple-converted-space">            </span>monthAgo.setMonth(today.getMonth() - 1);</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>document.getElementById('searchStartDate').value = formatDateForInput(monthAgo);</p>
<p class="p1"><span class="Apple-converted-space">            </span>document.getElementById('searchEndDate').value = formatDateForInput(today);</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Initialize UI elements</p>
<p class="p1"><span class="Apple-converted-space">            </span>updateUI();</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Setup budget reset day options</p>
<p class="p1"><span class="Apple-converted-space">            </span>updateBudgetResetDayOptions();</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Initialize quick amount buttons</p>
<p class="p1"><span class="Apple-converted-space">            </span>initQuickAmountButtons();</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Initialize account icons</p>
<p class="p1"><span class="Apple-converted-space">            </span>initAccountIcons();</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Search transactions with default values</p>
<p class="p1"><span class="Apple-converted-space">            </span>searchTransactions();</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Check for budget reset</p>
<p class="p1"><span class="Apple-converted-space">            </span>checkBudgetReset();</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Check new day status</p>
<p class="p1"><span class="Apple-converted-space">            </span>checkNewDayStatus();</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>// Load data from localStorage or initialize defaults</p>
<p class="p1"><span class="Apple-converted-space">        </span>function loadData() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (hasLocalStorage) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>try {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>const storedAccounts = localStorage.getItem('finance_accounts');</p>
<p class="p1"><span class="Apple-converted-space">                    </span>accounts = storedAccounts ? JSON.parse(storedAccounts) : [];</p>
<p class="p2"><span class="Apple-converted-space">                    </span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>const storedCategories = localStorage.getItem('finance_categories');</p>
<p class="p1"><span class="Apple-converted-space">                    </span>categories = storedCategories ? JSON.parse(storedCategories) : { income: [], expense: [] };</p>
<p class="p2"><span class="Apple-converted-space">                    </span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>const storedTransactions = localStorage.getItem('finance_transactions');</p>
<p class="p1"><span class="Apple-converted-space">                    </span>transactions = storedTransactions ? JSON.parse(storedTransactions) : [];</p>
<p class="p2"><span class="Apple-converted-space">                    </span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>const storedBudget = localStorage.getItem('finance_budget');</p>
<p class="p1"><span class="Apple-converted-space">                    </span>budget = storedBudget ? JSON.parse(storedBudget) : budget;</p>
<p class="p2"><span class="Apple-converted-space">                    </span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>const storedNewDayStatus = localStorage.getItem('finance_new_day_status');</p>
<p class="p1"><span class="Apple-converted-space">                    </span>newDayStatus = storedNewDayStatus ? JSON.parse(storedNewDayStatus) : newDayStatus;</p>
<p class="p1"><span class="Apple-converted-space">                </span>} catch (error) {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>console.error('Error loading data:', error);</p>
<p class="p1"><span class="Apple-converted-space">                    </span>initDefaultData();</p>
<p class="p1"><span class="Apple-converted-space">                </span>}</p>
<p class="p1"><span class="Apple-converted-space">            </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">                </span>initDefaultData();</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// If no accounts exist, add a default one</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (accounts.length === 0) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>accounts.push({</p>
<p class="p1"><span class="Apple-converted-space">                    </span>id: generateId(),</p>
<p class="p1"><span class="Apple-converted-space">                    </span>name: '<span class="s1">現金</span>',</p>
<p class="p1"><span class="Apple-converted-space">                    </span>balance: 0,</p>
<p class="p1"><span class="Apple-converted-space">                    </span>icon: '<span class="s2">💵</span>'</p>
<p class="p1"><span class="Apple-converted-space">                </span>});</p>
<p class="p1"><span class="Apple-converted-space">                </span>saveData('accounts');</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Initialize default categories if empty</p>
<p class="p1"><span class="Apple-converted-space">            </span>initDefaultCategories();</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>// Save data to localStorage</p>
<p class="p1"><span class="Apple-converted-space">        </span>function saveData(dataType) {</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (!hasLocalStorage) return;</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>try {</p>
<p class="p1"><span class="Apple-converted-space">                </span>switch (dataType) {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>case 'accounts':</p>
<p class="p1"><span class="Apple-converted-space">                        </span>localStorage.setItem('finance_accounts', JSON.stringify(accounts));</p>
<p class="p1"><span class="Apple-converted-space">                        </span>break;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>case 'categories':</p>
<p class="p1"><span class="Apple-converted-space">                        </span>localStorage.setItem('finance_categories', JSON.stringify(categories));</p>
<p class="p1"><span class="Apple-converted-space">                        </span>break;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>case 'transactions':</p>
<p class="p1"><span class="Apple-converted-space">                        </span>localStorage.setItem('finance_transactions', JSON.stringify(transactions));</p>
<p class="p1"><span class="Apple-converted-space">                        </span>break;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>case 'budget':</p>
<p class="p1"><span class="Apple-converted-space">                        </span>localStorage.setItem('finance_budget', JSON.stringify(budget));</p>
<p class="p1"><span class="Apple-converted-space">                        </span>break;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>case 'newDayStatus':</p>
<p class="p1"><span class="Apple-converted-space">                        </span>localStorage.setItem('finance_new_day_status', JSON.stringify(newDayStatus));</p>
<p class="p1"><span class="Apple-converted-space">                        </span>break;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>default:</p>
<p class="p1"><span class="Apple-converted-space">                        </span>// Save all</p>
<p class="p1"><span class="Apple-converted-space">                        </span>localStorage.setItem('finance_accounts', JSON.stringify(accounts));</p>
<p class="p1"><span class="Apple-converted-space">                        </span>localStorage.setItem('finance_categories', JSON.stringify(categories));</p>
<p class="p1"><span class="Apple-converted-space">                        </span>localStorage.setItem('finance_transactions', JSON.stringify(transactions));</p>
<p class="p1"><span class="Apple-converted-space">                        </span>localStorage.setItem('finance_budget', JSON.stringify(budget));</p>
<p class="p1"><span class="Apple-converted-space">                        </span>localStorage.setItem('finance_new_day_status', JSON.stringify(newDayStatus));</p>
<p class="p1"><span class="Apple-converted-space">                </span>}</p>
<p class="p1"><span class="Apple-converted-space">            </span>} catch (error) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>console.error('Error saving data:', error);</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>// Initialize default data</p>
<p class="p1"><span class="Apple-converted-space">        </span>function initDefaultData() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>// Reset to defaults</p>
<p class="p1"><span class="Apple-converted-space">            </span>accounts = [{</p>
<p class="p1"><span class="Apple-converted-space">                </span>id: generateId(),</p>
<p class="p1"><span class="Apple-converted-space">                </span>name: '<span class="s1">現金</span>',</p>
<p class="p1"><span class="Apple-converted-space">                </span>balance: 0,</p>
<p class="p1"><span class="Apple-converted-space">                </span>icon: '<span class="s2">💵</span>'</p>
<p class="p1"><span class="Apple-converted-space">            </span>}];</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>categories = {</p>
<p class="p1"><span class="Apple-converted-space">                </span>income: ['<span class="s1">薪資</span>', '<span class="s1">獎金</span>', '<span class="s1">投資收益</span>', '<span class="s1">禮金</span>', '<span class="s1">其他收入</span>'],</p>
<p class="p1"><span class="Apple-converted-space">                </span>expense: ['<span class="s1">食品</span>', '<span class="s1">交通</span>', '<span class="s1">住房</span>', '<span class="s1">娛樂</span>', '<span class="s1">服裝</span>', '<span class="s1">醫療</span>', '<span class="s1">教育</span>', '<span class="s1">其他支出</span>']</p>
<p class="p1"><span class="Apple-converted-space">            </span>};</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>transactions = [];</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>budget = {</p>
<p class="p1"><span class="Apple-converted-space">                </span>amount: 0,</p>
<p class="p1"><span class="Apple-converted-space">                </span>cycle: 'monthly',</p>
<p class="p1"><span class="Apple-converted-space">                </span>resetDay: 1,</p>
<p class="p1"><span class="Apple-converted-space">                </span>alertThreshold: 80,</p>
<p class="p1"><span class="Apple-converted-space">                </span>lastReset: null</p>
<p class="p1"><span class="Apple-converted-space">            </span>};</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>newDayStatus = {</p>
<p class="p1"><span class="Apple-converted-space">                </span>active: false,</p>
<p class="p1"><span class="Apple-converted-space">                </span>lastActivated: null</p>
<p class="p1"><span class="Apple-converted-space">            </span>};</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>// Initialize default categories</p>
<p class="p1"><span class="Apple-converted-space">        </span>function initDefaultCategories() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (!categories.income || categories.income.length === 0) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>categories.income = ['<span class="s1">薪資</span>', '<span class="s1">獎金</span>', '<span class="s1">投資收益</span>', '<span class="s1">禮金</span>', '<span class="s1">其他收入</span>'];</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>if (!categories.expense || categories.expense.length === 0) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>categories.expense = ['<span class="s1">食品</span>', '<span class="s1">交通</span>', '<span class="s1">住房</span>', '<span class="s1">娛樂</span>', '<span class="s1">服裝</span>', '<span class="s1">醫療</span>', '<span class="s1">教育</span>', '<span class="s1">其他支出</span>'];</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>saveData('categories');</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>// Export data to JSON string</p>
<p class="p1"><span class="Apple-converted-space">        </span>function exportData() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>const exportData = {</p>
<p class="p1"><span class="Apple-converted-space">                </span>accounts: accounts,</p>
<p class="p1"><span class="Apple-converted-space">                </span>categories: categories,</p>
<p class="p1"><span class="Apple-converted-space">                </span>transactions: transactions,</p>
<p class="p1"><span class="Apple-converted-space">                </span>budget: budget,</p>
<p class="p1"><span class="Apple-converted-space">                </span>newDayStatus: newDayStatus,</p>
<p class="p1"><span class="Apple-converted-space">                </span>exportDate: new Date().toISOString()</p>
<p class="p1"><span class="Apple-converted-space">            </span>};</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>return JSON.stringify(exportData, null, 2);</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>// Import data from JSON string</p>
<p class="p1"><span class="Apple-converted-space">        </span>function importData(jsonString) {</p>
<p class="p1"><span class="Apple-converted-space">            </span>try {</p>
<p class="p1"><span class="Apple-converted-space">                </span>const importedData = JSON.parse(jsonString);</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>// Validate required data structures</p>
<p class="p1"><span class="Apple-converted-space">                </span>if (!importedData.accounts || !Array.isArray(importedData.accounts) ||</p>
<p class="p1"><span class="Apple-converted-space">                    </span>!importedData.categories || !importedData.categories.income || !importedData.categories.expense ||</p>
<p class="p1"><span class="Apple-converted-space">                    </span>!importedData.transactions || !Array.isArray(importedData.transactions)) {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>throw new Error('<span class="s1">匯入的數據格式不正確</span>');</p>
<p class="p1"><span class="Apple-converted-space">                </span>}</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>// Import data</p>
<p class="p1"><span class="Apple-converted-space">                </span>accounts = importedData.accounts;</p>
<p class="p1"><span class="Apple-converted-space">                </span>categories = importedData.categories;</p>
<p class="p1"><span class="Apple-converted-space">                </span>transactions = importedData.transactions;</p>
<p class="p1"><span class="Apple-converted-space">                </span>budget = importedData.budget || budget;</p>
<p class="p1"><span class="Apple-converted-space">                </span>newDayStatus = importedData.newDayStatus || newDayStatus;</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>// Save to localStorage</p>
<p class="p1"><span class="Apple-converted-space">                </span>saveData();</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>// Update UI</p>
<p class="p1"><span class="Apple-converted-space">                </span>updateUI();</p>
<p class="p1"><span class="Apple-converted-space">                </span>searchTransactions();</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>return true;</p>
<p class="p1"><span class="Apple-converted-space">            </span>} catch (error) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>console.error('Import error:', error);</p>
<p class="p1"><span class="Apple-converted-space">                </span>notify('<span class="s2">❌</span>', '<span class="s1">匯入失敗</span>', '<span class="s1">匯入的數據格式不正確</span>');</p>
<p class="p1"><span class="Apple-converted-space">                </span>return false;</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>// Check if budget needs to be reset</p>
<p class="p1"><span class="Apple-converted-space">        </span>function checkBudgetReset() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (!budget.lastReset || !budget.amount) return;</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>const now = new Date();</p>
<p class="p1"><span class="Apple-converted-space">            </span>const lastReset = new Date(budget.lastReset);</p>
<p class="p1"><span class="Apple-converted-space">            </span>let shouldReset = false;</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>switch (budget.cycle) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>case 'daily':</p>
<p class="p1"><span class="Apple-converted-space">                    </span>// Reset if it's a new day</p>
<p class="p1"><span class="Apple-converted-space">                    </span>shouldReset = now.getDate() !== lastReset.getDate() ||<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">                                </span>now.getMonth() !== lastReset.getMonth() ||<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">                                </span>now.getFullYear() !== lastReset.getFullYear();</p>
<p class="p1"><span class="Apple-converted-space">                    </span>break;</p>
<p class="p1"><span class="Apple-converted-space">                </span>case 'weekly':</p>
<p class="p1"><span class="Apple-converted-space">                    </span>// Reset if it's the reset day of the week and a week has passed</p>
<p class="p1"><span class="Apple-converted-space">                    </span>const dayIndex = ['<span class="s1">週日</span>', '<span class="s1">週一</span>', '<span class="s1">週二</span>', '<span class="s1">週三</span>', '<span class="s1">週四</span>', '<span class="s1">週五</span>', '<span class="s1">週六</span>'].indexOf(budget.resetDay);</p>
<p class="p1"><span class="Apple-converted-space">                    </span>if (dayIndex === now.getDay()) {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>const dayDiff = (now - lastReset) / (1000 * 60 * 60 * 24);</p>
<p class="p1"><span class="Apple-converted-space">                        </span>shouldReset = dayDiff &gt;= 7;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>}</p>
<p class="p1"><span class="Apple-converted-space">                    </span>break;</p>
<p class="p1"><span class="Apple-converted-space">                </span>case 'monthly':</p>
<p class="p1"><span class="Apple-converted-space">                    </span>// Reset if it's the reset day of the month</p>
<p class="p1"><span class="Apple-converted-space">                    </span>shouldReset = now.getDate() === parseInt(budget.resetDay) &amp;&amp;<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">                                </span>(now.getMonth() !== lastReset.getMonth() || now.getFullYear() !== lastReset.getFullYear());</p>
<p class="p1"><span class="Apple-converted-space">                    </span>break;</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>if (shouldReset) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>budget.lastReset = now.toISOString();</p>
<p class="p1"><span class="Apple-converted-space">                </span>saveData('budget');</p>
<p class="p1"><span class="Apple-converted-space">                </span>notify('<span class="s2">🔄</span>', '<span class="s1">預算已重設</span>', '<span class="s1">您的預算已根據設定的週期重設。</span>');</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>// Check new day status</p>
<p class="p1"><span class="Apple-converted-space">        </span>function checkNewDayStatus() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (!newDayStatus.lastActivated) return;</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>const now = new Date();</p>
<p class="p1"><span class="Apple-converted-space">            </span>const lastActivated = new Date(newDayStatus.lastActivated);</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// If it's a new calendar day, reset the new day status</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (now.getDate() !== lastActivated.getDate() ||<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>now.getMonth() !== lastActivated.getMonth() ||<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>now.getFullYear() !== lastActivated.getFullYear()) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>newDayStatus.active = false;</p>
<p class="p1"><span class="Apple-converted-space">                </span>saveData('newDayStatus');</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>// Start a new day</p>
<p class="p1"><span class="Apple-converted-space">        </span>function startNewDay() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>newDayStatus.active = true;</p>
<p class="p1"><span class="Apple-converted-space">            </span>newDayStatus.lastActivated = new Date().toISOString();</p>
<p class="p1"><span class="Apple-converted-space">            </span>saveData('newDayStatus');</p>
<p class="p1"><span class="Apple-converted-space">            </span>notify('<span class="s2">🌅</span>', '<span class="s1">新的一天已開始</span>', '<span class="s1">從現在開始，所有交易將記錄為今天的日期。</span>');</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>// Update the UI with current data</p>
<p class="p1"><span class="Apple-converted-space">        </span>function updateUI() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>// Update dashboard</p>
<p class="p1"><span class="Apple-converted-space">            </span>updateDashboard();</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Update accounts tab</p>
<p class="p1"><span class="Apple-converted-space">            </span>updateAccountsTab();</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Update transaction categories</p>
<p class="p1"><span class="Apple-converted-space">            </span>updateTransactionCategories();</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Update statistics categories</p>
<p class="p1"><span class="Apple-converted-space">            </span>updateStatisticsCategories();</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Update account dropdowns</p>
<p class="p1"><span class="Apple-converted-space">            </span>updateAccountDropdowns();</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Update budget status</p>
<p class="p1"><span class="Apple-converted-space">            </span>updateBudgetStatus();</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>// Update dashboard with current data</p>
<p class="p1"><span class="Apple-converted-space">        </span>function updateDashboard() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>// Update total balance</p>
<p class="p1"><span class="Apple-converted-space">            </span>document.getElementById('totalBalance').textContent = formatNumber(getTotalBalance());</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Update today income/expense</p>
<p class="p1"><span class="Apple-converted-space">            </span>document.getElementById('todayIncome').textContent = formatNumber(getTodayIncome());</p>
<p class="p1"><span class="Apple-converted-space">            </span>document.getElementById('todayExpense').textContent = formatNumber(getTodayExpense());</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Update today transactions</p>
<p class="p1"><span class="Apple-converted-space">            </span>updateTodayTransactions();</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Update recent transactions</p>
<p class="p1"><span class="Apple-converted-space">            </span>updateRecentTransactions();</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>// Update today's transactions on dashboard</p>
<p class="p1"><span class="Apple-converted-space">        </span>function updateTodayTransactions() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>const todayTransactions = getTodayTransactions();</p>
<p class="p1"><span class="Apple-converted-space">            </span>const todayTransactionsEmpty = document.getElementById('todayTransactionsEmpty');</p>
<p class="p1"><span class="Apple-converted-space">            </span>const todayTransactionsTable = document.getElementById('todayTransactionsTable');</p>
<p class="p1"><span class="Apple-converted-space">            </span>const todayTransactionsList = document.getElementById('todayTransactionsList');</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>if (todayTransactions.length === 0) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>todayTransactionsEmpty.style.display = 'block';</p>
<p class="p1"><span class="Apple-converted-space">                </span>todayTransactionsTable.style.display = 'none';</p>
<p class="p1"><span class="Apple-converted-space">                </span>return;</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>todayTransactionsEmpty.style.display = 'none';</p>
<p class="p1"><span class="Apple-converted-space">            </span>todayTransactionsTable.style.display = 'block';</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Clear previous content</p>
<p class="p1"><span class="Apple-converted-space">            </span>todayTransactionsList.innerHTML = '';</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Add each transaction</p>
<p class="p1"><span class="Apple-converted-space">            </span>todayTransactions.forEach(transaction =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                </span>const row = document.createElement('tr');</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>// Type</p>
<p class="p1"><span class="Apple-converted-space">                </span>const typeCell = document.createElement('td');</p>
<p class="p1"><span class="Apple-converted-space">                </span>typeCell.className = 'px-6 py-4 whitespace-nowrap';</p>
<p class="p1"><span class="Apple-converted-space">                </span>typeCell.textContent = transaction.type === 'income' ? '<span class="s2">📈</span> <span class="s1">收入</span>' : '<span class="s2">📉</span> <span class="s1">支出</span>';</p>
<p class="p1"><span class="Apple-converted-space">                </span>row.appendChild(typeCell);</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>// Account</p>
<p class="p1"><span class="Apple-converted-space">                </span>const accountCell = document.createElement('td');</p>
<p class="p1"><span class="Apple-converted-space">                </span>accountCell.className = 'px-6 py-4 whitespace-nowrap';</p>
<p class="p1"><span class="Apple-converted-space">                </span>accountCell.textContent = getAccountName(transaction.account);</p>
<p class="p1"><span class="Apple-converted-space">                </span>row.appendChild(accountCell);</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>// Category</p>
<p class="p1"><span class="Apple-converted-space">                </span>const categoryCell = document.createElement('td');</p>
<p class="p1"><span class="Apple-converted-space">                </span>categoryCell.className = 'px-6 py-4 whitespace-nowrap';</p>
<p class="p1"><span class="Apple-converted-space">                </span>categoryCell.textContent = transaction.category;</p>
<p class="p1"><span class="Apple-converted-space">                </span>row.appendChild(categoryCell);</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>// Amount</p>
<p class="p1"><span class="Apple-converted-space">                </span>const amountCell = document.createElement('td');</p>
<p class="p1"><span class="Apple-converted-space">                </span>amountCell.className = 'px-6 py-4 whitespace-nowrap';</p>
<p class="p1"><span class="Apple-converted-space">                </span>if (transaction.type === 'income') {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>amountCell.classList.add('text-green-600');</p>
<p class="p1"><span class="Apple-converted-space">                    </span>amountCell.classList.add('font-medium');</p>
<p class="p1"><span class="Apple-converted-space">                </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>amountCell.classList.add('text-red-600');</p>
<p class="p1"><span class="Apple-converted-space">                    </span>amountCell.classList.add('font-medium');</p>
<p class="p1"><span class="Apple-converted-space">                </span>}</p>
<p class="p1"><span class="Apple-converted-space">                </span>amountCell.textContent = '$' + formatNumber(transaction.amount);</p>
<p class="p1"><span class="Apple-converted-space">                </span>row.appendChild(amountCell);</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>// Note</p>
<p class="p1"><span class="Apple-converted-space">                </span>const noteCell = document.createElement('td');</p>
<p class="p1"><span class="Apple-converted-space">                </span>noteCell.className = 'px-6 py-4 whitespace-nowrap text-gray-500';</p>
<p class="p1"><span class="Apple-converted-space">                </span>noteCell.textContent = transaction.note || '-';</p>
<p class="p1"><span class="Apple-converted-space">                </span>row.appendChild(noteCell);</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>todayTransactionsList.appendChild(row);</p>
<p class="p1"><span class="Apple-converted-space">            </span>});</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>// Update recent transactions on dashboard</p>
<p class="p1"><span class="Apple-converted-space">        </span>function updateRecentTransactions() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>const recentTransactions = getRecentTransactions(5);</p>
<p class="p1"><span class="Apple-converted-space">            </span>const noTransactions = document.getElementById('noTransactions');</p>
<p class="p1"><span class="Apple-converted-space">            </span>const recentTransactionsEl = document.getElementById('recentTransactions');</p>
<p class="p1"><span class="Apple-converted-space">            </span>const recentTransactionsList = document.getElementById('recentTransactionsList');</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>if (recentTransactions.length === 0) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>noTransactions.style.display = 'block';</p>
<p class="p1"><span class="Apple-converted-space">                </span>recentTransactionsEl.style.display = 'none';</p>
<p class="p1"><span class="Apple-converted-space">                </span>return;</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>noTransactions.style.display = 'none';</p>
<p class="p1"><span class="Apple-converted-space">            </span>recentTransactionsEl.style.display = 'block';</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Clear previous content</p>
<p class="p1"><span class="Apple-converted-space">            </span>recentTransactionsList.innerHTML = '';</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Add each transaction</p>
<p class="p1"><span class="Apple-converted-space">            </span>recentTransactions.forEach(transaction =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                </span>const li = document.createElement('li');</p>
<p class="p1"><span class="Apple-converted-space">                </span>li.className = 'px-4 py-3 hover:bg-gray-50 flex justify-between items-center';</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>const leftDiv = document.createElement('div');</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>const emojiSpan = document.createElement('span');</p>
<p class="p1"><span class="Apple-converted-space">                </span>emojiSpan.className = 'mr-2';</p>
<p class="p1"><span class="Apple-converted-space">                </span>emojiSpan.textContent = transaction.type === 'income' ? '<span class="s2">💹</span>' : '<span class="s2">💸</span>';</p>
<p class="p1"><span class="Apple-converted-space">                </span>leftDiv.appendChild(emojiSpan);</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>const categorySpan = document.createElement('span');</p>
<p class="p1"><span class="Apple-converted-space">                </span>categorySpan.textContent = transaction.category;</p>
<p class="p1"><span class="Apple-converted-space">                </span>leftDiv.appendChild(categorySpan);</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>const dateDiv = document.createElement('div');</p>
<p class="p1"><span class="Apple-converted-space">                </span>dateDiv.className = 'text-sm text-gray-500';</p>
<p class="p1"><span class="Apple-converted-space">                </span>dateDiv.textContent = formatDate(transaction.date);</p>
<p class="p1"><span class="Apple-converted-space">                </span>leftDiv.appendChild(dateDiv);</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>const amountDiv = document.createElement('div');</p>
<p class="p1"><span class="Apple-converted-space">                </span>if (transaction.type === 'income') {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>amountDiv.classList.add('text-green-600');</p>
<p class="p1"><span class="Apple-converted-space">                    </span>amountDiv.classList.add('font-medium');</p>
<p class="p1"><span class="Apple-converted-space">                </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>amountDiv.classList.add('text-red-600');</p>
<p class="p1"><span class="Apple-converted-space">                    </span>amountDiv.classList.add('font-medium');</p>
<p class="p1"><span class="Apple-converted-space">                </span>}</p>
<p class="p1"><span class="Apple-converted-space">                </span>amountDiv.textContent = '$' + formatNumber(transaction.amount);</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>li.appendChild(leftDiv);</p>
<p class="p1"><span class="Apple-converted-space">                </span>li.appendChild(amountDiv);</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>recentTransactionsList.appendChild(li);</p>
<p class="p1"><span class="Apple-converted-space">            </span>});</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>// Update accounts tab</p>
<p class="p1"><span class="Apple-converted-space">        </span>function updateAccountsTab() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>const accountsGrid = document.getElementById('accountsGrid');</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Clear previous content</p>
<p class="p1"><span class="Apple-converted-space">            </span>accountsGrid.innerHTML = '';</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Add each account</p>
<p class="p1"><span class="Apple-converted-space">            </span>accounts.forEach(account =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                </span>const accountCard = document.createElement('div');</p>
<p class="p1"><span class="Apple-converted-space">                </span>accountCard.className = 'bg-white p-6 rounded-lg shadow relative';</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>const actionsDiv = document.createElement('div');</p>
<p class="p1"><span class="Apple-converted-space">                </span>actionsDiv.className = 'absolute top-2 right-2 flex space-x-1';</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>const deleteBtn = document.createElement('button');</p>
<p class="p1"><span class="Apple-converted-space">                </span>deleteBtn.className = 'text-red-500 hover:text-red-700';</p>
<p class="p1"><span class="Apple-converted-space">                </span>deleteBtn.innerHTML = '&lt;i class="fas fa-trash-alt"&gt;&lt;/i&gt;';</p>
<p class="p1"><span class="Apple-converted-space">                </span>deleteBtn.addEventListener('click', () =&gt; deleteAccount(account.id));</p>
<p class="p1"><span class="Apple-converted-space">                </span>actionsDiv.appendChild(deleteBtn);</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>const iconDiv = document.createElement('div');</p>
<p class="p1"><span class="Apple-converted-space">                </span>iconDiv.className = 'text-3xl mb-2 emoji-btn';</p>
<p class="p1"><span class="Apple-converted-space">                </span>iconDiv.textContent = account.icon || '<span class="s2">💳</span>';</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>const nameHeading = document.createElement('h3');</p>
<p class="p1"><span class="Apple-converted-space">                </span>nameHeading.className = 'text-lg font-bold mb-1';</p>
<p class="p1"><span class="Apple-converted-space">                </span>nameHeading.textContent = account.name;</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>const balanceDiv = document.createElement('div');</p>
<p class="p1"><span class="Apple-converted-space">                </span>balanceDiv.className = 'text-2xl font-bold';</p>
<p class="p1"><span class="Apple-converted-space">                </span>balanceDiv.textContent = '$' + formatNumber(account.balance);</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>accountCard.appendChild(actionsDiv);</p>
<p class="p1"><span class="Apple-converted-space">                </span>accountCard.appendChild(iconDiv);</p>
<p class="p1"><span class="Apple-converted-space">                </span>accountCard.appendChild(nameHeading);</p>
<p class="p1"><span class="Apple-converted-space">                </span>accountCard.appendChild(balanceDiv);</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>accountsGrid.appendChild(accountCard);</p>
<p class="p1"><span class="Apple-converted-space">            </span>});</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Add the "Add New Account" card</p>
<p class="p1"><span class="Apple-converted-space">            </span>const addNewCard = document.createElement('div');</p>
<p class="p1"><span class="Apple-converted-space">            </span>addNewCard.className = 'bg-gray-100 p-6 rounded-lg shadow border-2 border-dashed border-gray-300 flex flex-col items-center justify-center cursor-pointer hover:bg-gray-200 transition';</p>
<p class="p1"><span class="Apple-converted-space">            </span>addNewCard.innerHTML = `</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div class="text-3xl mb-2"&gt;<span class="s2">➕</span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;h3 class="text-lg font-medium text-gray-600"&gt;<span class="s1">新增戶口</span>&lt;/h3&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>`;</p>
<p class="p1"><span class="Apple-converted-space">            </span>addNewCard.addEventListener('click', () =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                </span>document.getElementById('newAccountName').value = '';</p>
<p class="p1"><span class="Apple-converted-space">                </span>document.getElementById('newAccountBalance').value = '';</p>
<p class="p1"><span class="Apple-converted-space">                </span>selectedIcon = '<span class="s2">💳</span>';</p>
<p class="p1"><span class="Apple-converted-space">                </span>updateSelectedAccountIcon();</p>
<p class="p1"><span class="Apple-converted-space">                </span>openModal('newAccountModal');</p>
<p class="p1"><span class="Apple-converted-space">            </span>});</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>accountsGrid.appendChild(addNewCard);</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>// Update account dropdowns in various forms</p>
<p class="p1"><span class="Apple-converted-space">        </span>function updateAccountDropdowns() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>const transferFrom = document.getElementById('transferFrom');</p>
<p class="p1"><span class="Apple-converted-space">            </span>const transferTo = document.getElementById('transferTo');</p>
<p class="p1"><span class="Apple-converted-space">            </span>const transactionAccount = document.getElementById('transactionAccount');</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Clear previous options</p>
<p class="p1"><span class="Apple-converted-space">            </span>transferFrom.innerHTML = '&lt;option value="" disabled selected&gt;<span class="s1">選擇戶口</span>&lt;/option&gt;';</p>
<p class="p1"><span class="Apple-converted-space">            </span>transferTo.innerHTML = '&lt;option value="" disabled selected&gt;<span class="s1">選擇戶口</span>&lt;/option&gt;';</p>
<p class="p1"><span class="Apple-converted-space">            </span>transactionAccount.innerHTML = '&lt;option value="" disabled selected&gt;<span class="s1">選擇戶口</span>&lt;/option&gt;';</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Add account options</p>
<p class="p1"><span class="Apple-converted-space">            </span>accounts.forEach(account =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                </span>const option1 = document.createElement('option');</p>
<p class="p1"><span class="Apple-converted-space">                </span>option1.value = account.id;</p>
<p class="p1"><span class="Apple-converted-space">                </span>option1.textContent = account.name;</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>const option2 = document.createElement('option');</p>
<p class="p1"><span class="Apple-converted-space">                </span>option2.value = account.id;</p>
<p class="p1"><span class="Apple-converted-space">                </span>option2.textContent = account.name;</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>const option3 = document.createElement('option');</p>
<p class="p1"><span class="Apple-converted-space">                </span>option3.value = account.id;</p>
<p class="p1"><span class="Apple-converted-space">                </span>option3.textContent = account.name;</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>transferFrom.appendChild(option1);</p>
<p class="p1"><span class="Apple-converted-space">                </span>transferTo.appendChild(option2);</p>
<p class="p1"><span class="Apple-converted-space">                </span>transactionAccount.appendChild(option3);</p>
<p class="p1"><span class="Apple-converted-space">            </span>});</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>// Update transaction categories dropdown based on selected type</p>
<p class="p1"><span class="Apple-converted-space">        </span>function updateTransactionCategories() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>const transactionCategory = document.getElementById('transactionCategory');</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Clear previous options</p>
<p class="p1"><span class="Apple-converted-space">            </span>transactionCategory.innerHTML = '&lt;option value="" disabled selected&gt;<span class="s1">選擇類別</span>&lt;/option&gt;';</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Add category options based on current transaction type</p>
<p class="p1"><span class="Apple-converted-space">            </span>const categoriesList = categories[transactionType] || [];</p>
<p class="p1"><span class="Apple-converted-space">            </span>categoriesList.forEach(category =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                </span>const option = document.createElement('option');</p>
<p class="p1"><span class="Apple-converted-space">                </span>option.value = category;</p>
<p class="p1"><span class="Apple-converted-space">                </span>option.textContent = category;</p>
<p class="p1"><span class="Apple-converted-space">                </span>transactionCategory.appendChild(option);</p>
<p class="p1"><span class="Apple-converted-space">            </span>});</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>// Update statistics categories dropdown</p>
<p class="p1"><span class="Apple-converted-space">        </span>function updateStatisticsCategories() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>const searchCategory = document.getElementById('searchCategory');</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Clear previous options</p>
<p class="p1"><span class="Apple-converted-space">            </span>searchCategory.innerHTML = '&lt;option value=""&gt;<span class="s1">全部類別</span>&lt;/option&gt;';</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Add all categories</p>
<p class="p1"><span class="Apple-converted-space">            </span>const allCategories = [...categories.income, ...categories.expense];</p>
<p class="p1"><span class="Apple-converted-space">            </span>const uniqueCategories = [...new Set(allCategories)]; // Remove duplicates</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>uniqueCategories.forEach(category =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                </span>const option = document.createElement('option');</p>
<p class="p1"><span class="Apple-converted-space">                </span>option.value = category;</p>
<p class="p1"><span class="Apple-converted-space">                </span>option.textContent = category;</p>
<p class="p1"><span class="Apple-converted-space">                </span>searchCategory.appendChild(option);</p>
<p class="p1"><span class="Apple-converted-space">            </span>});</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>// Update budget status on dashboard</p>
<p class="p1"><span class="Apple-converted-space">        </span>function updateBudgetStatus() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>const noBudget = document.getElementById('noBudget');</p>
<p class="p1"><span class="Apple-converted-space">            </span>const budgetStatus = document.getElementById('budgetStatus');</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>if (!budget.amount) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>noBudget.style.display = 'block';</p>
<p class="p1"><span class="Apple-converted-space">                </span>budgetStatus.style.display = 'none';</p>
<p class="p1"><span class="Apple-converted-space">                </span>return;</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>noBudget.style.display = 'none';</p>
<p class="p1"><span class="Apple-converted-space">            </span>budgetStatus.style.display = 'block';</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Update budget info</p>
<p class="p1"><span class="Apple-converted-space">            </span>document.getElementById('budgetCycleText').textContent = getBudgetCycleText();</p>
<p class="p1"><span class="Apple-converted-space">            </span>document.getElementById('budgetAmount').textContent = formatNumber(budget.amount);</p>
<p class="p1"><span class="Apple-converted-space">            </span>document.getElementById('budgetUsed').textContent = formatNumber(getBudgetUsed());</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>const remaining = getBudgetRemaining();</p>
<p class="p1"><span class="Apple-converted-space">            </span>const remainingEl = document.getElementById('budgetRemaining');</p>
<p class="p1"><span class="Apple-converted-space">            </span>remainingEl.textContent = '$' + formatNumber(remaining);</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>if (remaining &lt; 0) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>remainingEl.classList.add('text-red-600');</p>
<p class="p1"><span class="Apple-converted-space">            </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">                </span>remainingEl.classList.add('text-green-600');</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Update budget bar</p>
<p class="p1"><span class="Apple-converted-space">            </span>const percentage = getBudgetPercentage();</p>
<p class="p1"><span class="Apple-converted-space">            </span>const budgetBar = document.getElementById('budgetBar');</p>
<p class="p1"><span class="Apple-converted-space">            </span>budgetBar.style.width = Math.min(percentage, 100) + '%';</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>if (percentage &gt; 100) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>budgetBar.classList.add('bg-red-600');</p>
<p class="p1"><span class="Apple-converted-space">                </span>budgetBar.classList.remove('bg-primary');</p>
<p class="p1"><span class="Apple-converted-space">            </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">                </span>budgetBar.classList.add('bg-primary');</p>
<p class="p1"><span class="Apple-converted-space">                </span>budgetBar.classList.remove('bg-red-600');</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>document.getElementById('budgetPercentage').textContent = percentage + '% <span class="s1">已使用</span>';</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Update budget form</p>
<p class="p1"><span class="Apple-converted-space">            </span>document.getElementById('budgetAmountInput').value = budget.amount;</p>
<p class="p1"><span class="Apple-converted-space">            </span>document.getElementById('budgetCycle').value = budget.cycle;</p>
<p class="p1"><span class="Apple-converted-space">            </span>document.getElementById('budgetAlertThreshold').value = budget.alertThreshold;</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (budget.resetDay) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>document.getElementById('budgetResetDay').value = budget.resetDay;</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>// Update budget reset day options based on selected cycle</p>
<p class="p1"><span class="Apple-converted-space">        </span>function updateBudgetResetDayOptions() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>const budgetCycle = document.getElementById('budgetCycle').value;</p>
<p class="p1"><span class="Apple-converted-space">            </span>const budgetResetDay = document.getElementById('budgetResetDay');</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Clear previous options</p>
<p class="p1"><span class="Apple-converted-space">            </span>budgetResetDay.innerHTML = '';</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Add options based on cycle</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (budgetCycle === 'daily') {</p>
<p class="p1"><span class="Apple-converted-space">                </span>budgetResetDay.disabled = true;</p>
<p class="p1"><span class="Apple-converted-space">                </span>const option = document.createElement('option');</p>
<p class="p1"><span class="Apple-converted-space">                </span>option.value = '1';</p>
<p class="p1"><span class="Apple-converted-space">                </span>option.textContent = '<span class="s1">每日自動重設</span>';</p>
<p class="p1"><span class="Apple-converted-space">                </span>budgetResetDay.appendChild(option);</p>
<p class="p1"><span class="Apple-converted-space">            </span>} else if (budgetCycle === 'weekly') {</p>
<p class="p1"><span class="Apple-converted-space">                </span>budgetResetDay.disabled = false;</p>
<p class="p1"><span class="Apple-converted-space">                </span>const days = ['<span class="s1">週一</span>', '<span class="s1">週二</span>', '<span class="s1">週三</span>', '<span class="s1">週四</span>', '<span class="s1">週五</span>', '<span class="s1">週六</span>', '<span class="s1">週日</span>'];</p>
<p class="p1"><span class="Apple-converted-space">                </span>days.forEach(day =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>const option = document.createElement('option');</p>
<p class="p1"><span class="Apple-converted-space">                    </span>option.value = day;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>option.textContent = day;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>budgetResetDay.appendChild(option);</p>
<p class="p1"><span class="Apple-converted-space">                </span>});</p>
<p class="p1"><span class="Apple-converted-space">            </span>} else if (budgetCycle === 'monthly') {</p>
<p class="p1"><span class="Apple-converted-space">                </span>budgetResetDay.disabled = false;</p>
<p class="p1"><span class="Apple-converted-space">                </span>for (let i = 1; i &lt;= 31; i++) {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>const option = document.createElement('option');</p>
<p class="p1"><span class="Apple-converted-space">                    </span>option.value = i;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>option.textContent = i + '<span class="s1">日</span>';</p>
<p class="p1"><span class="Apple-converted-space">                    </span>budgetResetDay.appendChild(option);</p>
<p class="p1"><span class="Apple-converted-space">                </span>}</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Set default value</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (budget.resetDay) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>// Try to find the value in the options</p>
<p class="p1"><span class="Apple-converted-space">                </span>const options = Array.from(budgetResetDay.options);</p>
<p class="p1"><span class="Apple-converted-space">                </span>const matchingOption = options.find(option =&gt; option.value == budget.resetDay);</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>if (matchingOption) {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>budgetResetDay.value = budget.resetDay;</p>
<p class="p1"><span class="Apple-converted-space">                </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>// If not found (e.g. when switching from monthly to weekly), set the first option</p>
<p class="p1"><span class="Apple-converted-space">                    </span>budgetResetDay.selectedIndex = 0;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>budget.resetDay = budgetResetDay.value;</p>
<p class="p1"><span class="Apple-converted-space">                </span>}</p>
<p class="p1"><span class="Apple-converted-space">            </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">                </span>// Set default reset day if not specified</p>
<p class="p1"><span class="Apple-converted-space">                </span>budgetResetDay.selectedIndex = 0;</p>
<p class="p1"><span class="Apple-converted-space">                </span>budget.resetDay = budgetResetDay.value;</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>// Initialize quick amount buttons</p>
<p class="p1"><span class="Apple-converted-space">        </span>function initQuickAmountButtons() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>const quickAmounts = document.getElementById('quickAmounts');</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Clear previous buttons</p>
<p class="p1"><span class="Apple-converted-space">            </span>quickAmounts.innerHTML = '';</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Add quick amount buttons</p>
<p class="p1"><span class="Apple-converted-space">            </span>[10, 20, 50, 100, 200, 500, 1000].forEach(amount =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                </span>const button = document.createElement('button');</p>
<p class="p1"><span class="Apple-converted-space">                </span>button.className = 'bg-gray-200 hover:bg-gray-300 px-3 py-1 rounded-md text-gray-700';</p>
<p class="p1"><span class="Apple-converted-space">                </span>button.textContent = '$' + amount;</p>
<p class="p1"><span class="Apple-converted-space">                </span>button.addEventListener('click', () =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>document.getElementById('transactionAmount').value = amount;</p>
<p class="p1"><span class="Apple-converted-space">                </span>});</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>quickAmounts.appendChild(button);</p>
<p class="p1"><span class="Apple-converted-space">            </span>});</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>// Initialize account icons</p>
<p class="p1"><span class="Apple-converted-space">        </span>function initAccountIcons() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>const accountIcons = document.getElementById('accountIcons');</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Clear previous icons</p>
<p class="p1"><span class="Apple-converted-space">            </span>accountIcons.innerHTML = '';</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Add account icons</p>
<p class="p1"><span class="Apple-converted-space">            </span>['<span class="s2">💳</span>', '<span class="s2">💰</span>', '<span class="s2">🏦</span>', '<span class="s2">💴</span>', '<span class="s2">💵</span>', '<span class="s2">💶</span>', '<span class="s2">💷</span>', '<span class="s2">🪙</span>', '<span class="s2">💸</span>', '<span class="s2">💹</span>'].forEach(icon =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                </span>const button = document.createElement('button');</p>
<p class="p1"><span class="Apple-converted-space">                </span>button.className = 'p-2 rounded-md text-xl emoji-btn';</p>
<p class="p1"><span class="Apple-converted-space">                </span>if (selectedIcon === icon) {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>button.classList.add('bg-primary');</p>
<p class="p1"><span class="Apple-converted-space">                    </span>button.classList.add('text-white');</p>
<p class="p1"><span class="Apple-converted-space">                </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>button.classList.add('bg-gray-100');</p>
<p class="p1"><span class="Apple-converted-space">                </span>}</p>
<p class="p1"><span class="Apple-converted-space">                </span>button.textContent = icon;</p>
<p class="p1"><span class="Apple-converted-space">                </span>button.addEventListener('click', () =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>selectedIcon = icon;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>updateSelectedAccountIcon();</p>
<p class="p1"><span class="Apple-converted-space">                </span>});</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>accountIcons.appendChild(button);</p>
<p class="p1"><span class="Apple-converted-space">            </span>});</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>// Update selected account icon</p>
<p class="p1"><span class="Apple-converted-space">        </span>function updateSelectedAccountIcon() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>const buttons = document.querySelectorAll('#accountIcons button');</p>
<p class="p1"><span class="Apple-converted-space">            </span>buttons.forEach(button =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                </span>if (button.textContent === selectedIcon) {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>button.classList.remove('bg-gray-100');</p>
<p class="p1"><span class="Apple-converted-space">                    </span>button.classList.add('bg-primary', 'text-white');</p>
<p class="p1"><span class="Apple-converted-space">                </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>button.classList.remove('bg-primary', 'text-white');</p>
<p class="p1"><span class="Apple-converted-space">                    </span>button.classList.add('bg-gray-100');</p>
<p class="p1"><span class="Apple-converted-space">                </span>}</p>
<p class="p1"><span class="Apple-converted-space">            </span>});</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>// Setup event listeners</p>
<p class="p1"><span class="Apple-converted-space">        </span>function setupEventListeners() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>// Tab switching</p>
<p class="p1"><span class="Apple-converted-space">            </span>tabButtons.forEach(button =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                </span>button.addEventListener('click', () =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>const tabId = button.getAttribute('data-tab');</p>
<p class="p1"><span class="Apple-converted-space">                    </span>switchTab(tabId);</p>
<p class="p1"><span class="Apple-converted-space">                </span>});</p>
<p class="p1"><span class="Apple-converted-space">            </span>});</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Close modal buttons</p>
<p class="p1"><span class="Apple-converted-space">            </span>document.querySelectorAll('.close').forEach(closeBtn =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                </span>closeBtn.addEventListener('click', event =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>const modal = event.target.closest('.modal');</p>
<p class="p1"><span class="Apple-converted-space">                    </span>closeModal(modal.id);</p>
<p class="p1"><span class="Apple-converted-space">                </span>});</p>
<p class="p1"><span class="Apple-converted-space">            </span>});</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// New day button</p>
<p class="p1"><span class="Apple-converted-space">            </span>document.getElementById('newDayBtn').addEventListener('click', startNewDay);</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Import/Export button</p>
<p class="p1"><span class="Apple-converted-space">            </span>document.getElementById('importExportBtn').addEventListener('click', () =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                </span>document.getElementById('exportDataArea').value = exportData();</p>
<p class="p1"><span class="Apple-converted-space">                </span>document.getElementById('importDataArea').value = '';</p>
<p class="p1"><span class="Apple-converted-space">                </span>openModal('importExportModal');</p>
<p class="p1"><span class="Apple-converted-space">            </span>});</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Copy export data button</p>
<p class="p1"><span class="Apple-converted-space">            </span>document.getElementById('copyExportBtn').addEventListener('click', () =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                </span>const exportArea = document.getElementById('exportDataArea');</p>
<p class="p1"><span class="Apple-converted-space">                </span>exportArea.select();</p>
<p class="p1"><span class="Apple-converted-space">                </span>document.execCommand('copy');</p>
<p class="p1"><span class="Apple-converted-space">                </span>notify('<span class="s2">✅</span>', '<span class="s1">已複製</span>', '<span class="s1">數據已成功複製到剪貼板</span>');</p>
<p class="p1"><span class="Apple-converted-space">            </span>});</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Import data button</p>
<p class="p1"><span class="Apple-converted-space">            </span>document.getElementById('importDataBtn').addEventListener('click', () =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                </span>const importArea = document.getElementById('importDataArea');</p>
<p class="p1"><span class="Apple-converted-space">                </span>const result = importData(importArea.value);</p>
<p class="p1"><span class="Apple-converted-space">                </span>if (result) {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>closeModal('importExportModal');</p>
<p class="p1"><span class="Apple-converted-space">                    </span>notify('<span class="s2">✅</span>', '<span class="s1">匯入成功</span>', '<span class="s1">數據已成功匯入</span>');</p>
<p class="p1"><span class="Apple-converted-space">                </span>}</p>
<p class="p1"><span class="Apple-converted-space">            </span>});</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Go to budget tab button</p>
<p class="p1"><span class="Apple-converted-space">            </span>document.getElementById('goBudgetBtn').addEventListener('click', () =&gt; switchTab('budget'));</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// View all transactions button</p>
<p class="p1"><span class="Apple-converted-space">            </span>document.getElementById('viewAllTransactionsBtn').addEventListener('click', () =&gt; switchTab('stats'));</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Transaction type buttons</p>
<p class="p1"><span class="Apple-converted-space">            </span>document.getElementById('incomeBtn').addEventListener('click', () =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                </span>transactionType = 'income';</p>
<p class="p1"><span class="Apple-converted-space">                </span>updateTransactionTypeUI();</p>
<p class="p1"><span class="Apple-converted-space">                </span>updateTransactionCategories();</p>
<p class="p1"><span class="Apple-converted-space">            </span>});</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>document.getElementById('expenseBtn').addEventListener('click', () =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                </span>transactionType = 'expense';</p>
<p class="p1"><span class="Apple-converted-space">                </span>updateTransactionTypeUI();</p>
<p class="p1"><span class="Apple-converted-space">                </span>updateTransactionCategories();</p>
<p class="p1"><span class="Apple-converted-space">            </span>});</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// New category type buttons</p>
<p class="p1"><span class="Apple-converted-space">            </span>document.getElementById('newCategoryIncomeBtn').addEventListener('click', () =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                </span>selectedCategoryType = 'income';</p>
<p class="p1"><span class="Apple-converted-space">                </span>updateNewCategoryTypeUI();</p>
<p class="p1"><span class="Apple-converted-space">            </span>});</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>document.getElementById('newCategoryExpenseBtn').addEventListener('click', () =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                </span>selectedCategoryType = 'expense';</p>
<p class="p1"><span class="Apple-converted-space">                </span>updateNewCategoryTypeUI();</p>
<p class="p1"><span class="Apple-converted-space">            </span>});</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Add account button</p>
<p class="p1"><span class="Apple-converted-space">            </span>document.getElementById('addAccountBtn').addEventListener('click', addAccount);</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Add category button</p>
<p class="p1"><span class="Apple-converted-space">            </span>document.getElementById('addCategoryBtn').addEventListener('click', () =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                </span>document.getElementById('newCategoryName').value = '';</p>
<p class="p1"><span class="Apple-converted-space">                </span>updateNewCategoryTypeUI();</p>
<p class="p1"><span class="Apple-converted-space">                </span>openModal('newCategoryModal');</p>
<p class="p1"><span class="Apple-converted-space">            </span>});</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Add category confirm button</p>
<p class="p1"><span class="Apple-converted-space">            </span>document.getElementById('addCategoryConfirmBtn').addEventListener('click', addCategory);</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Transfer money button</p>
<p class="p1"><span class="Apple-converted-space">            </span>document.getElementById('transferBtn').addEventListener('click', transferMoney);</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Save transaction button</p>
<p class="p1"><span class="Apple-converted-space">            </span>document.getElementById('saveTransactionBtn').addEventListener('click', addTransaction);</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Save budget button</p>
<p class="p1"><span class="Apple-converted-space">            </span>document.getElementById('saveBudgetBtn').addEventListener('click', saveBudget);</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Search button</p>
<p class="p1"><span class="Apple-converted-space">            </span>document.getElementById('searchBtn').addEventListener('click', searchTransactions);</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Budget cycle change</p>
<p class="p1"><span class="Apple-converted-space">            </span>document.getElementById('budgetCycle').addEventListener('change', updateBudgetResetDayOptions);</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Click outside modal to close</p>
<p class="p1"><span class="Apple-converted-space">            </span>window.addEventListener('click', event =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                </span>if (event.target.classList.contains('modal')) {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>closeModal(event.target.id);</p>
<p class="p1"><span class="Apple-converted-space">                </span>}</p>
<p class="p1"><span class="Apple-converted-space">            </span>});</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>// Switch tabs</p>
<p class="p1"><span class="Apple-converted-space">        </span>function switchTab(tabId) {</p>
<p class="p1"><span class="Apple-converted-space">            </span>// Update tab buttons</p>
<p class="p1"><span class="Apple-converted-space">            </span>tabButtons.forEach(button =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                </span>const buttonTabId = button.getAttribute('data-tab');</p>
<p class="p1"><span class="Apple-converted-space">                </span>if (buttonTabId === tabId) {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>button.classList.add('text-primary', 'border-primary');</p>
<p class="p1"><span class="Apple-converted-space">                    </span>button.classList.remove('text-gray-500', 'hover:text-gray-700', 'border-transparent');</p>
<p class="p1"><span class="Apple-converted-space">                </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>button.classList.remove('text-primary', 'border-primary');</p>
<p class="p1"><span class="Apple-converted-space">                    </span>button.classList.add('text-gray-500', 'hover:text-gray-700', 'border-transparent');</p>
<p class="p1"><span class="Apple-converted-space">                </span>}</p>
<p class="p1"><span class="Apple-converted-space">            </span>});</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Update tab contents</p>
<p class="p1"><span class="Apple-converted-space">            </span>tabContents.forEach(content =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                </span>if (content.id === tabId) {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>content.classList.add('active');</p>
<p class="p1"><span class="Apple-converted-space">                </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>content.classList.remove('active');</p>
<p class="p1"><span class="Apple-converted-space">                </span>}</p>
<p class="p1"><span class="Apple-converted-space">            </span>});</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Specific actions for certain tabs</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (tabId === 'transactions') {</p>
<p class="p1"><span class="Apple-converted-space">                </span>// Reset new transaction form when switching to transactions tab</p>
<p class="p1"><span class="Apple-converted-space">                </span>document.getElementById('transactionAccount').value = '';</p>
<p class="p1"><span class="Apple-converted-space">                </span>document.getElementById('transactionCategory').value = '';</p>
<p class="p1"><span class="Apple-converted-space">                </span>document.getElementById('transactionAmount').value = '';</p>
<p class="p1"><span class="Apple-converted-space">                </span>document.getElementById('transactionDate').value = getTodayFormatted();</p>
<p class="p1"><span class="Apple-converted-space">                </span>document.getElementById('transactionNote').value = '';</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>// Keep transaction type</p>
<p class="p1"><span class="Apple-converted-space">                </span>updateTransactionTypeUI();</p>
<p class="p1"><span class="Apple-converted-space">                </span>updateTransactionCategories();</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>// Open a modal</p>
<p class="p1"><span class="Apple-converted-space">        </span>function openModal(modalId) {</p>
<p class="p1"><span class="Apple-converted-space">            </span>const modal = document.getElementById(modalId);</p>
<p class="p1"><span class="Apple-converted-space">            </span>modal.style.display = 'block';</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>// Close a modal</p>
<p class="p1"><span class="Apple-converted-space">        </span>function closeModal(modalId) {</p>
<p class="p1"><span class="Apple-converted-space">            </span>const modal = document.getElementById(modalId);</p>
<p class="p1"><span class="Apple-converted-space">            </span>modal.style.display = 'none';</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>// Update transaction type UI</p>
<p class="p1"><span class="Apple-converted-space">        </span>function updateTransactionTypeUI() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>const incomeBtn = document.getElementById('incomeBtn');</p>
<p class="p1"><span class="Apple-converted-space">            </span>const expenseBtn = document.getElementById('expenseBtn');</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>if (transactionType === 'income') {</p>
<p class="p1"><span class="Apple-converted-space">                </span>incomeBtn.classList.remove('bg-gray-200', 'text-gray-700');</p>
<p class="p1"><span class="Apple-converted-space">                </span>incomeBtn.classList.add('bg-green-500', 'text-white');</p>
<p class="p1"><span class="Apple-converted-space">                </span>expenseBtn.classList.remove('bg-red-500', 'text-white');</p>
<p class="p1"><span class="Apple-converted-space">                </span>expenseBtn.classList.add('bg-gray-200', 'text-gray-700');</p>
<p class="p1"><span class="Apple-converted-space">            </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">                </span>incomeBtn.classList.remove('bg-green-500', 'text-white');</p>
<p class="p1"><span class="Apple-converted-space">                </span>incomeBtn.classList.add('bg-gray-200', 'text-gray-700');</p>
<p class="p1"><span class="Apple-converted-space">                </span>expenseBtn.classList.remove('bg-gray-200', 'text-gray-700');</p>
<p class="p1"><span class="Apple-converted-space">                </span>expenseBtn.classList.add('bg-red-500', 'text-white');</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>// Update new category type UI</p>
<p class="p1"><span class="Apple-converted-space">        </span>function updateNewCategoryTypeUI() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>const incomeBtn = document.getElementById('newCategoryIncomeBtn');</p>
<p class="p1"><span class="Apple-converted-space">            </span>const expenseBtn = document.getElementById('newCategoryExpenseBtn');</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>if (selectedCategoryType === 'income') {</p>
<p class="p1"><span class="Apple-converted-space">                </span>incomeBtn.classList.remove('bg-gray-200', 'text-gray-700');</p>
<p class="p1"><span class="Apple-converted-space">                </span>incomeBtn.classList.add('bg-green-500', 'text-white');</p>
<p class="p1"><span class="Apple-converted-space">                </span>expenseBtn.classList.remove('bg-red-500', 'text-white');</p>
<p class="p1"><span class="Apple-converted-space">                </span>expenseBtn.classList.add('bg-gray-200', 'text-gray-700');</p>
<p class="p1"><span class="Apple-converted-space">            </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">                </span>incomeBtn.classList.remove('bg-green-500', 'text-white');</p>
<p class="p1"><span class="Apple-converted-space">                </span>incomeBtn.classList.add('bg-gray-200', 'text-gray-700');</p>
<p class="p1"><span class="Apple-converted-space">                </span>expenseBtn.classList.remove('bg-gray-200', 'text-gray-700');</p>
<p class="p1"><span class="Apple-converted-space">                </span>expenseBtn.classList.add('bg-red-500', 'text-white');</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>// Add an account</p>
<p class="p1"><span class="Apple-converted-space">        </span>function addAccount() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>const nameInput = document.getElementById('newAccountName');</p>
<p class="p1"><span class="Apple-converted-space">            </span>const balanceInput = document.getElementById('newAccountBalance');</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>const name = nameInput.value.trim();</p>
<p class="p1"><span class="Apple-converted-space">            </span>const balance = parseFloat(balanceInput.value);</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>if (!name || isNaN(balance)) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>notify('<span class="s2">❌</span>', '<span class="s1">新增戶口失敗</span>', '<span class="s1">請填寫完整的戶口資料。</span>');</p>
<p class="p1"><span class="Apple-converted-space">                </span>return;</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>const newAccount = {</p>
<p class="p1"><span class="Apple-converted-space">                </span>id: generateId(),</p>
<p class="p1"><span class="Apple-converted-space">                </span>name: name,</p>
<p class="p1"><span class="Apple-converted-space">                </span>balance: balance,</p>
<p class="p1"><span class="Apple-converted-space">                </span>icon: selectedIcon</p>
<p class="p1"><span class="Apple-converted-space">            </span>};</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>accounts.push(newAccount);</p>
<p class="p1"><span class="Apple-converted-space">            </span>saveData('accounts');</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>closeModal('newAccountModal');</p>
<p class="p1"><span class="Apple-converted-space">            </span>updateAccountsTab();</p>
<p class="p1"><span class="Apple-converted-space">            </span>updateAccountDropdowns();</p>
<p class="p1"><span class="Apple-converted-space">            </span>updateDashboard();</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>notify('<span class="s2">✅</span>', '<span class="s1">戶口已新增</span>', `<span class="s1">「</span>${name}<span class="s1">」戶口已成功新增。</span>`);</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>// Delete an account</p>
<p class="p1"><span class="Apple-converted-space">        </span>function deleteAccount(accountId) {</p>
<p class="p1"><span class="Apple-converted-space">            </span>const accountName = getAccountName(accountId);</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Check if there are transactions using this account</p>
<p class="p1"><span class="Apple-converted-space">            </span>const hasTransactions = transactions.some(t =&gt; t.account === accountId);</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>if (hasTransactions) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>notify('<span class="s2">❌</span>', '<span class="s1">無法刪除戶口</span>', `<span class="s1">「</span>${accountName}<span class="s1">」戶口有相關交易記錄，無法刪除。</span>`);</p>
<p class="p1"><span class="Apple-converted-space">                </span>return;</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>accounts = accounts.filter(a =&gt; a.id !== accountId);</p>
<p class="p1"><span class="Apple-converted-space">            </span>saveData('accounts');</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>updateAccountsTab();</p>
<p class="p1"><span class="Apple-converted-space">            </span>updateAccountDropdowns();</p>
<p class="p1"><span class="Apple-converted-space">            </span>updateDashboard();</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>notify('<span class="s2">🗑️</span>', '<span class="s1">戶口已刪除</span>', `<span class="s1">「</span>${accountName}<span class="s1">」戶口已成功刪除。</span>`);</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>// Add a category</p>
<p class="p1"><span class="Apple-converted-space">        </span>function addCategory() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>const nameInput = document.getElementById('newCategoryName');</p>
<p class="p1"><span class="Apple-converted-space">            </span>const name = nameInput.value.trim();</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>if (!name) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>notify('<span class="s2">❌</span>', '<span class="s1">新增類別失敗</span>', '<span class="s1">請輸入類別名稱。</span>');</p>
<p class="p1"><span class="Apple-converted-space">                </span>return;</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Check if category already exists</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (categories[selectedCategoryType].includes(name)) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>notify('<span class="s2">❌</span>', '<span class="s1">類別已存在</span>', `<span class="s1">「</span>${name}<span class="s1">」類別已經存在。</span>`);</p>
<p class="p1"><span class="Apple-converted-space">                </span>return;</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>categories[selectedCategoryType].push(name);</p>
<p class="p1"><span class="Apple-converted-space">            </span>saveData('categories');</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>closeModal('newCategoryModal');</p>
<p class="p1"><span class="Apple-converted-space">            </span>updateTransactionCategories();</p>
<p class="p1"><span class="Apple-converted-space">            </span>updateStatisticsCategories();</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// If adding a category while in transaction form, select it</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (transactionType === selectedCategoryType) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>const categorySelect = document.getElementById('transactionCategory');</p>
<p class="p1"><span class="Apple-converted-space">                </span>const newOption = document.createElement('option');</p>
<p class="p1"><span class="Apple-converted-space">                </span>newOption.value = name;</p>
<p class="p1"><span class="Apple-converted-space">                </span>newOption.textContent = name;</p>
<p class="p1"><span class="Apple-converted-space">                </span>categorySelect.appendChild(newOption);</p>
<p class="p1"><span class="Apple-converted-space">                </span>categorySelect.value = name;</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>notify('<span class="s2">✅</span>', '<span class="s1">類別已新增</span>', '<span class="s1">新類別已成功新增。</span>');</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>// Transfer money between accounts</p>
<p class="p1"><span class="Apple-converted-space">        </span>function transferMoney() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>const fromSelect = document.getElementById('transferFrom');</p>
<p class="p1"><span class="Apple-converted-space">            </span>const toSelect = document.getElementById('transferTo');</p>
<p class="p1"><span class="Apple-converted-space">            </span>const amountInput = document.getElementById('transferAmount');</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>const fromId = fromSelect.value;</p>
<p class="p1"><span class="Apple-converted-space">            </span>const toId = toSelect.value;</p>
<p class="p1"><span class="Apple-converted-space">            </span>const amount = parseFloat(amountInput.value);</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>if (!fromId || !toId || isNaN(amount) || amount &lt;= 0 || fromId === toId) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>notify('<span class="s2">❌</span>', '<span class="s1">轉賬失敗</span>', '<span class="s1">請填寫有效的轉賬資料。</span>');</p>
<p class="p1"><span class="Apple-converted-space">                </span>return;</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Find accounts</p>
<p class="p1"><span class="Apple-converted-space">            </span>const fromAccountIndex = accounts.findIndex(a =&gt; a.id === fromId);</p>
<p class="p1"><span class="Apple-converted-space">            </span>const toAccountIndex = accounts.findIndex(a =&gt; a.id === toId);</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>if (fromAccountIndex === -1 || toAccountIndex === -1) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>notify('<span class="s2">❌</span>', '<span class="s1">轉賬失敗</span>', '<span class="s1">找不到指定的戶口。</span>');</p>
<p class="p1"><span class="Apple-converted-space">                </span>return;</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Check if from account has enough balance</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (accounts[fromAccountIndex].balance &lt; amount) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>notify('<span class="s2">❌</span>', '<span class="s1">轉賬失敗</span>', '<span class="s1">餘額不足。</span>');</p>
<p class="p1"><span class="Apple-converted-space">                </span>return;</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Update balances</p>
<p class="p1"><span class="Apple-converted-space">            </span>accounts[fromAccountIndex].balance -= amount;</p>
<p class="p1"><span class="Apple-converted-space">            </span>accounts[toAccountIndex].balance += amount;</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Record transaction</p>
<p class="p1"><span class="Apple-converted-space">            </span>const now = new Date();</p>
<p class="p1"><span class="Apple-converted-space">            </span>const fromAccountName = accounts[fromAccountIndex].name;</p>
<p class="p1"><span class="Apple-converted-space">            </span>const toAccountName = accounts[toAccountIndex].name;</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>transactions.push({</p>
<p class="p1"><span class="Apple-converted-space">                </span>id: generateId(),</p>
<p class="p1"><span class="Apple-converted-space">                </span>type: 'transfer',</p>
<p class="p1"><span class="Apple-converted-space">                </span>account: fromId,</p>
<p class="p1"><span class="Apple-converted-space">                </span>toAccount: toId,</p>
<p class="p1"><span class="Apple-converted-space">                </span>amount: amount,</p>
<p class="p1"><span class="Apple-converted-space">                </span>date: getTransactionDate(now),</p>
<p class="p1"><span class="Apple-converted-space">                </span>note: `<span class="s1">從「</span>${fromAccountName}<span class="s1">」轉賬到「</span>${toAccountName}<span class="s1">」</span>`,</p>
<p class="p1"><span class="Apple-converted-space">                </span>category: '<span class="s1">戶口轉賬</span>'</p>
<p class="p1"><span class="Apple-converted-space">            </span>});</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>saveData('accounts');</p>
<p class="p1"><span class="Apple-converted-space">            </span>saveData('transactions');</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Reset form</p>
<p class="p1"><span class="Apple-converted-space">            </span>fromSelect.value = '';</p>
<p class="p1"><span class="Apple-converted-space">            </span>toSelect.value = '';</p>
<p class="p1"><span class="Apple-converted-space">            </span>amountInput.value = '';</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>updateAccountsTab();</p>
<p class="p1"><span class="Apple-converted-space">            </span>updateDashboard();</p>
<p class="p1"><span class="Apple-converted-space">            </span>searchTransactions();</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>notify('<span class="s2">✅</span>', '<span class="s1">轉賬成功</span>', `<span class="s1">已成功將</span> $${amount} <span class="s1">從「</span>${fromAccountName}<span class="s1">」轉賬到「</span>${toAccountName}<span class="s1">」。</span>`);</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>// Add a transaction</p>
<p class="p1"><span class="Apple-converted-space">        </span>function addTransaction() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>const accountSelect = document.getElementById('transactionAccount');</p>
<p class="p1"><span class="Apple-converted-space">            </span>const categorySelect = document.getElementById('transactionCategory');</p>
<p class="p1"><span class="Apple-converted-space">            </span>const amountInput = document.getElementById('transactionAmount');</p>
<p class="p1"><span class="Apple-converted-space">            </span>const dateInput = document.getElementById('transactionDate');</p>
<p class="p1"><span class="Apple-converted-space">            </span>const noteInput = document.getElementById('transactionNote');</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>const accountId = accountSelect.value;</p>
<p class="p1"><span class="Apple-converted-space">            </span>const category = categorySelect.value;</p>
<p class="p1"><span class="Apple-converted-space">            </span>const amount = parseFloat(amountInput.value);</p>
<p class="p1"><span class="Apple-converted-space">            </span>const date = dateInput.value;</p>
<p class="p1"><span class="Apple-converted-space">            </span>const note = noteInput.value.trim();</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>if (!accountId || !category || isNaN(amount) || amount &lt;= 0 || !date) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>notify('<span class="s2">❌</span>', '<span class="s1">交易失敗</span>', '<span class="s1">請填寫完整的交易資料。</span>');</p>
<p class="p1"><span class="Apple-converted-space">                </span>return;</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>const accountIndex = accounts.findIndex(a =&gt; a.id === accountId);</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>if (accountIndex === -1) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>notify('<span class="s2">❌</span>', '<span class="s1">交易失敗</span>', '<span class="s1">找不到指定的戶口。</span>');</p>
<p class="p1"><span class="Apple-converted-space">                </span>return;</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Update account balance</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (transactionType === 'income') {</p>
<p class="p1"><span class="Apple-converted-space">                </span>accounts[accountIndex].balance += amount;</p>
<p class="p1"><span class="Apple-converted-space">            </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">                </span>// Check if account has enough balance for expense</p>
<p class="p1"><span class="Apple-converted-space">                </span>if (accounts[accountIndex].balance &lt; amount) {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>notify('<span class="s2">⚠️</span>', '<span class="s1">餘額不足</span>', `<span class="s1">「</span>${accounts[accountIndex].name}<span class="s1">」戶口餘額不足，但交易仍已記錄。</span>`);</p>
<p class="p1"><span class="Apple-converted-space">                </span>}</p>
<p class="p1"><span class="Apple-converted-space">                </span>accounts[accountIndex].balance -= amount;</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Add transaction</p>
<p class="p1"><span class="Apple-converted-space">            </span>transactions.push({</p>
<p class="p1"><span class="Apple-converted-space">                </span>id: generateId(),</p>
<p class="p1"><span class="Apple-converted-space">                </span>type: transactionType,</p>
<p class="p1"><span class="Apple-converted-space">                </span>account: accountId,</p>
<p class="p1"><span class="Apple-converted-space">                </span>category: category,</p>
<p class="p1"><span class="Apple-converted-space">                </span>amount: amount,</p>
<p class="p1"><span class="Apple-converted-space">                </span>date: date,</p>
<p class="p1"><span class="Apple-converted-space">                </span>note: note,</p>
<p class="p1"><span class="Apple-converted-space">                </span>receipt: null</p>
<p class="p1"><span class="Apple-converted-space">            </span>});</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>saveData('accounts');</p>
<p class="p1"><span class="Apple-converted-space">            </span>saveData('transactions');</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Check if budget alert needed</p>
<p class="p1"><span class="Apple-converted-space">            </span>checkBudgetAlert();</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Reset form</p>
<p class="p1"><span class="Apple-converted-space">            </span>categorySelect.value = '';</p>
<p class="p1"><span class="Apple-converted-space">            </span>amountInput.value = '';</p>
<p class="p1"><span class="Apple-converted-space">            </span>noteInput.value = '';</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>updateAccountsTab();</p>
<p class="p1"><span class="Apple-converted-space">            </span>updateDashboard();</p>
<p class="p1"><span class="Apple-converted-space">            </span>searchTransactions();</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>notify('<span class="s2">✅</span>', '<span class="s1">交易已記錄</span>', `${transactionType === 'income' ? '<span class="s1">收入</span>' : '<span class="s1">支出</span>'}<span class="s1">交易已成功記錄。</span>`);</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>// Save budget settings</p>
<p class="p1"><span class="Apple-converted-space">        </span>function saveBudget() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>const amountInput = document.getElementById('budgetAmountInput');</p>
<p class="p1"><span class="Apple-converted-space">            </span>const cycleSelect = document.getElementById('budgetCycle');</p>
<p class="p1"><span class="Apple-converted-space">            </span>const resetDaySelect = document.getElementById('budgetResetDay');</p>
<p class="p1"><span class="Apple-converted-space">            </span>const alertThresholdInput = document.getElementById('budgetAlertThreshold');</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>const amount = parseFloat(amountInput.value);</p>
<p class="p1"><span class="Apple-converted-space">            </span>const cycle = cycleSelect.value;</p>
<p class="p1"><span class="Apple-converted-space">            </span>const resetDay = resetDaySelect.value;</p>
<p class="p1"><span class="Apple-converted-space">            </span>const alertThreshold = parseInt(alertThresholdInput.value);</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>if (isNaN(amount) || amount &lt;= 0) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>notify('<span class="s2">❌</span>', '<span class="s1">預算設定失敗</span>', '<span class="s1">請輸入有效的預算金額。</span>');</p>
<p class="p1"><span class="Apple-converted-space">                </span>return;</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>if (isNaN(alertThreshold) || alertThreshold &lt; 1 || alertThreshold &gt; 100) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>notify('<span class="s2">❌</span>', '<span class="s1">預算設定失敗</span>', '<span class="s1">請輸入有效的通知閾值</span> (1-100)<span class="s1">。</span>');</p>
<p class="p1"><span class="Apple-converted-space">                </span>return;</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>budget.amount = amount;</p>
<p class="p1"><span class="Apple-converted-space">            </span>budget.cycle = cycle;</p>
<p class="p1"><span class="Apple-converted-space">            </span>budget.resetDay = resetDay;</p>
<p class="p1"><span class="Apple-converted-space">            </span>budget.alertThreshold = alertThreshold;</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Set last reset to today if not already set</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (!budget.lastReset) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>budget.lastReset = new Date().toISOString();</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>saveData('budget');</p>
<p class="p1"><span class="Apple-converted-space">            </span>updateBudgetStatus();</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>notify('<span class="s2">✅</span>', '<span class="s1">預算已設定</span>', '<span class="s1">您的預算設定已成功保存。</span>');</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>// Search transactions</p>
<p class="p1"><span class="Apple-converted-space">        </span>function searchTransactions() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>const startDateInput = document.getElementById('searchStartDate');</p>
<p class="p1"><span class="Apple-converted-space">            </span>const endDateInput = document.getElementById('searchEndDate');</p>
<p class="p1"><span class="Apple-converted-space">            </span>const typeSelect = document.getElementById('searchType');</p>
<p class="p1"><span class="Apple-converted-space">            </span>const categorySelect = document.getElementById('searchCategory');</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>const startDate = startDateInput.value;</p>
<p class="p1"><span class="Apple-converted-space">            </span>const endDate = endDateInput.value;</p>
<p class="p1"><span class="Apple-converted-space">            </span>const type = typeSelect.value;</p>
<p class="p1"><span class="Apple-converted-space">            </span>const category = categorySelect.value;</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>let filtered = [...transactions];</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Filter by date range</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (startDate) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>filtered = filtered.filter(t =&gt; t.date &gt;= startDate);</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>if (endDate) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>// Include the entire end date</p>
<p class="p1"><span class="Apple-converted-space">                </span>const endDateObj = new Date(endDate);</p>
<p class="p1"><span class="Apple-converted-space">                </span>endDateObj.setHours(23, 59, 59, 999);</p>
<p class="p1"><span class="Apple-converted-space">                </span>const formattedEndDate = formatDateForInput(endDateObj);</p>
<p class="p1"><span class="Apple-converted-space">                </span>filtered = filtered.filter(t =&gt; t.date &lt;= formattedEndDate);</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Filter by type</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (type) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>filtered = filtered.filter(t =&gt; t.type === type);</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Filter by category</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (category) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>filtered = filtered.filter(t =&gt; t.category === category);</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Sort by date (newest first)</p>
<p class="p1"><span class="Apple-converted-space">            </span>filtered.sort((a, b) =&gt; new Date(b.date) - new Date(a.date));</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Update search results</p>
<p class="p1"><span class="Apple-converted-space">            </span>updateSearchResults(filtered);</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>// Update search results</p>
<p class="p1"><span class="Apple-converted-space">        </span>function updateSearchResults(results) {</p>
<p class="p1"><span class="Apple-converted-space">            </span>const noResults = document.getElementById('noSearchResults');</p>
<p class="p1"><span class="Apple-converted-space">            </span>const resultsTable = document.getElementById('searchResults');</p>
<p class="p1"><span class="Apple-converted-space">            </span>const resultsList = document.getElementById('searchResultsList');</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>if (results.length === 0) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>noResults.style.display = 'block';</p>
<p class="p1"><span class="Apple-converted-space">                </span>resultsTable.style.display = 'none';</p>
<p class="p1"><span class="Apple-converted-space">                </span>return;</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>noResults.style.display = 'none';</p>
<p class="p1"><span class="Apple-converted-space">            </span>resultsTable.style.display = 'block';</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Clear previous results</p>
<p class="p1"><span class="Apple-converted-space">            </span>resultsList.innerHTML = '';</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Add each result</p>
<p class="p1"><span class="Apple-converted-space">            </span>results.forEach(transaction =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                </span>const row = document.createElement('tr');</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>// Date</p>
<p class="p1"><span class="Apple-converted-space">                </span>const dateCell = document.createElement('td');</p>
<p class="p1"><span class="Apple-converted-space">                </span>dateCell.className = 'px-6 py-4 whitespace-nowrap text-sm text-gray-500';</p>
<p class="p1"><span class="Apple-converted-space">                </span>dateCell.textContent = formatDate(transaction.date);</p>
<p class="p1"><span class="Apple-converted-space">                </span>row.appendChild(dateCell);</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>// Type</p>
<p class="p1"><span class="Apple-converted-space">                </span>const typeCell = document.createElement('td');</p>
<p class="p1"><span class="Apple-converted-space">                </span>typeCell.className = 'px-6 py-4 whitespace-nowrap';</p>
<p class="p1"><span class="Apple-converted-space">                </span>typeCell.textContent = transaction.type === 'income' ? '<span class="s2">📈</span> <span class="s1">收入</span>' : (transaction.type === 'expense' ? '<span class="s2">📉</span> <span class="s1">支出</span>' : '<span class="s2">🔄</span> <span class="s1">轉賬</span>');</p>
<p class="p1"><span class="Apple-converted-space">                </span>row.appendChild(typeCell);</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>// Account</p>
<p class="p1"><span class="Apple-converted-space">                </span>const accountCell = document.createElement('td');</p>
<p class="p1"><span class="Apple-converted-space">                </span>accountCell.className = 'px-6 py-4 whitespace-nowrap';</p>
<p class="p1"><span class="Apple-converted-space">                </span>accountCell.textContent = getAccountName(transaction.account);</p>
<p class="p1"><span class="Apple-converted-space">                </span>row.appendChild(accountCell);</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>// Category</p>
<p class="p1"><span class="Apple-converted-space">                </span>const categoryCell = document.createElement('td');</p>
<p class="p1"><span class="Apple-converted-space">                </span>categoryCell.className = 'px-6 py-4 whitespace-nowrap';</p>
<p class="p1"><span class="Apple-converted-space">                </span>categoryCell.textContent = transaction.category;</p>
<p class="p1"><span class="Apple-converted-space">                </span>row.appendChild(categoryCell);</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>// Amount</p>
<p class="p1"><span class="Apple-converted-space">                </span>const amountCell = document.createElement('td');</p>
<p class="p1"><span class="Apple-converted-space">                </span>amountCell.className = 'px-6 py-4 whitespace-nowrap';</p>
<p class="p1"><span class="Apple-converted-space">                </span>if (transaction.type === 'income') {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>amountCell.classList.add('text-green-600');</p>
<p class="p1"><span class="Apple-converted-space">                    </span>amountCell.classList.add('font-medium');</p>
<p class="p1"><span class="Apple-converted-space">                </span>} else if (transaction.type === 'expense') {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>amountCell.classList.add('text-red-600');</p>
<p class="p1"><span class="Apple-converted-space">                    </span>amountCell.classList.add('font-medium');</p>
<p class="p1"><span class="Apple-converted-space">                </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>amountCell.classList.add('text-blue-600');</p>
<p class="p1"><span class="Apple-converted-space">                    </span>amountCell.classList.add('font-medium');</p>
<p class="p1"><span class="Apple-converted-space">                </span>}</p>
<p class="p1"><span class="Apple-converted-space">                </span>amountCell.textContent = '$' + formatNumber(transaction.amount);</p>
<p class="p1"><span class="Apple-converted-space">                </span>row.appendChild(amountCell);</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>// Note</p>
<p class="p1"><span class="Apple-converted-space">                </span>const noteCell = document.createElement('td');</p>
<p class="p1"><span class="Apple-converted-space">                </span>noteCell.className = 'px-6 py-4 whitespace-nowrap text-gray-500';</p>
<p class="p1"><span class="Apple-converted-space">                </span>noteCell.textContent = transaction.note || '-';</p>
<p class="p1"><span class="Apple-converted-space">                </span>row.appendChild(noteCell);</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>// Action</p>
<p class="p1"><span class="Apple-converted-space">                </span>const actionCell = document.createElement('td');</p>
<p class="p1"><span class="Apple-converted-space">                </span>actionCell.className = 'px-6 py-4 whitespace-nowrap text-right text-sm font-medium';</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>const deleteBtn = document.createElement('button');</p>
<p class="p1"><span class="Apple-converted-space">                </span>deleteBtn.className = 'text-red-600 hover:text-red-900';</p>
<p class="p1"><span class="Apple-converted-space">                </span>deleteBtn.textContent = '<span class="s1">刪除</span>';</p>
<p class="p1"><span class="Apple-converted-space">                </span>deleteBtn.addEventListener('click', () =&gt; deleteTransaction(transaction.id));</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>actionCell.appendChild(deleteBtn);</p>
<p class="p1"><span class="Apple-converted-space">                </span>row.appendChild(actionCell);</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>resultsList.appendChild(row);</p>
<p class="p1"><span class="Apple-converted-space">            </span>});</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>// Delete a transaction</p>
<p class="p1"><span class="Apple-converted-space">        </span>function deleteTransaction(transactionId) {</p>
<p class="p1"><span class="Apple-converted-space">            </span>const transaction = transactions.find(t =&gt; t.id === transactionId);</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (!transaction) return;</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Update account balance</p>
<p class="p1"><span class="Apple-converted-space">            </span>const accountIndex = accounts.findIndex(a =&gt; a.id === transaction.account);</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (accountIndex !== -1) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>if (transaction.type === 'income') {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>accounts[accountIndex].balance -= transaction.amount;</p>
<p class="p1"><span class="Apple-converted-space">                </span>} else if (transaction.type === 'expense') {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>accounts[accountIndex].balance += transaction.amount;</p>
<p class="p1"><span class="Apple-converted-space">                </span>} else if (transaction.type === 'transfer') {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>// Revert transfer</p>
<p class="p1"><span class="Apple-converted-space">                    </span>accounts[accountIndex].balance += transaction.amount;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>const toAccountIndex = accounts.findIndex(a =&gt; a.id === transaction.toAccount);</p>
<p class="p1"><span class="Apple-converted-space">                    </span>if (toAccountIndex !== -1) {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>accounts[toAccountIndex].balance -= transaction.amount;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>}</p>
<p class="p1"><span class="Apple-converted-space">                </span>}</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Remove transaction</p>
<p class="p1"><span class="Apple-converted-space">            </span>transactions = transactions.filter(t =&gt; t.id !== transactionId);</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>saveData('accounts');</p>
<p class="p1"><span class="Apple-converted-space">            </span>saveData('transactions');</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>updateAccountsTab();</p>
<p class="p1"><span class="Apple-converted-space">            </span>updateDashboard();</p>
<p class="p1"><span class="Apple-converted-space">            </span>searchTransactions();</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>notify('<span class="s2">🗑️</span>', '<span class="s1">交易已刪除</span>', '<span class="s1">交易記錄已成功刪除。</span>');</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>// Check if budget alert needed</p>
<p class="p1"><span class="Apple-converted-space">        </span>function checkBudgetAlert() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (!budget.amount || !budget.alertThreshold) return;</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>const budgetUsed = getBudgetUsed();</p>
<p class="p1"><span class="Apple-converted-space">            </span>const budgetPercentage = (budgetUsed / budget.amount) * 100;</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>if (budgetPercentage &gt;= budget.alertThreshold) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>notify('<span class="s2">⚠️</span>', '<span class="s1">預算警告</span>', `<span class="s1">您已使用了</span> ${Math.round(budgetPercentage)}% <span class="s1">的預算。</span>`);</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>// Show notification</p>
<p class="p1"><span class="Apple-converted-space">        </span>function notify(icon, title, message) {</p>
<p class="p1"><span class="Apple-converted-space">            </span>const notificationEl = document.getElementById('notification');</p>
<p class="p1"><span class="Apple-converted-space">            </span>document.getElementById('notificationIcon').textContent = icon;</p>
<p class="p1"><span class="Apple-converted-space">            </span>document.getElementById('notificationTitle').textContent = title;</p>
<p class="p1"><span class="Apple-converted-space">            </span>document.getElementById('notificationMessage').textContent = message;</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>notificationEl.style.display = 'block';</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Auto-hide notification after 3 seconds</p>
<p class="p1"><span class="Apple-converted-space">            </span>setTimeout(() =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                </span>notificationEl.style.display = 'none';</p>
<p class="p1"><span class="Apple-converted-space">            </span>}, 3000);</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>// Check for dark mode</p>
<p class="p1"><span class="Apple-converted-space">        </span>function checkDarkMode() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (window.matchMedia &amp;&amp; window.matchMedia('(prefers-color-scheme: dark)').matches) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>document.documentElement.classList.add('dark');</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', event =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                </span>if (event.matches) {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>document.documentElement.classList.add('dark');</p>
<p class="p1"><span class="Apple-converted-space">                </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>document.documentElement.classList.remove('dark');</p>
<p class="p1"><span class="Apple-converted-space">                </span>}</p>
<p class="p1"><span class="Apple-converted-space">            </span>});</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>// Helper functions</p>
<p class="p1"><span class="Apple-converted-space">        </span>function generateId() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>return Date.now().toString(36) + Math.random().toString(36).substr(2, 5);</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>function getAccountName(accountId) {</p>
<p class="p1"><span class="Apple-converted-space">            </span>const account = accounts.find(a =&gt; a.id === accountId);</p>
<p class="p1"><span class="Apple-converted-space">            </span>return account ? account.name : '<span class="s1">未知戶口</span>';</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>function getTodayFormatted() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>return formatDateForInput(new Date());</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>function formatDateForInput(date) {</p>
<p class="p1"><span class="Apple-converted-space">            </span>const year = date.getFullYear();</p>
<p class="p1"><span class="Apple-converted-space">            </span>const month = String(date.getMonth() + 1).padStart(2, '0');</p>
<p class="p1"><span class="Apple-converted-space">            </span>const day = String(date.getDate()).padStart(2, '0');</p>
<p class="p1"><span class="Apple-converted-space">            </span>return `${year}-${month}-${day}`;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>function formatDate(dateString) {</p>
<p class="p1"><span class="Apple-converted-space">            </span>const date = new Date(dateString);</p>
<p class="p1"><span class="Apple-converted-space">            </span>const year = date.getFullYear();</p>
<p class="p1"><span class="Apple-converted-space">            </span>const month = String(date.getMonth() + 1).padStart(2, '0');</p>
<p class="p1"><span class="Apple-converted-space">            </span>const day = String(date.getDate()).padStart(2, '0');</p>
<p class="p1"><span class="Apple-converted-space">            </span>return `${year}/${month}/${day}`;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>function formatNumber(number) {</p>
<p class="p1"><span class="Apple-converted-space">            </span>return parseFloat(number).toFixed(2).replace(/\B(?=(\d{3})+(?!\d))/g, ",");</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>function getTransactionDate(date) {</p>
<p class="p1"><span class="Apple-converted-space">            </span>// If new day is active, use today's date</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (newDayStatus.active) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>return formatDateForInput(date);</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// If not active and it's after midnight but before 4am, use yesterday's date</p>
<p class="p1"><span class="Apple-converted-space">            </span>const hours = date.getHours();</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (hours &gt;= 0 &amp;&amp; hours &lt; 4) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>const yesterday = new Date(date);</p>
<p class="p1"><span class="Apple-converted-space">                </span>yesterday.setDate(yesterday.getDate() - 1);</p>
<p class="p1"><span class="Apple-converted-space">                </span>return formatDateForInput(yesterday);</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Otherwise use today's date</p>
<p class="p1"><span class="Apple-converted-space">            </span>return formatDateForInput(date);</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>function getTotalBalance() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>return accounts.reduce((sum, account) =&gt; sum + account.balance, 0);</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>function getTodayTransactions() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>const today = getTodayFormatted();</p>
<p class="p1"><span class="Apple-converted-space">            </span>return transactions.filter(t =&gt; t.date === today)</p>
<p class="p1"><span class="Apple-converted-space">                </span>.sort((a, b) =&gt; new Date(b.date) - new Date(a.date));</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>function getTodayIncome() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>return getTodayTransactions()</p>
<p class="p1"><span class="Apple-converted-space">                </span>.filter(t =&gt; t.type === 'income')</p>
<p class="p1"><span class="Apple-converted-space">                </span>.reduce((sum, t) =&gt; sum + parseFloat(t.amount), 0);</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>function getTodayExpense() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>return getTodayTransactions()</p>
<p class="p1"><span class="Apple-converted-space">                </span>.filter(t =&gt; t.type === 'expense')</p>
<p class="p1"><span class="Apple-converted-space">                </span>.reduce((sum, t) =&gt; sum + parseFloat(t.amount), 0);</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>function getRecentTransactions(count) {</p>
<p class="p1"><span class="Apple-converted-space">            </span>return [...transactions]</p>
<p class="p1"><span class="Apple-converted-space">                </span>.sort((a, b) =&gt; new Date(b.date) - new Date(a.date))</p>
<p class="p1"><span class="Apple-converted-space">                </span>.slice(0, count);</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>function getBudgetCycleText() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>switch (budget.cycle) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>case 'daily':</p>
<p class="p1"><span class="Apple-converted-space">                    </span>return '<span class="s1">每日</span>';</p>
<p class="p1"><span class="Apple-converted-space">                </span>case 'weekly':</p>
<p class="p1"><span class="Apple-converted-space">                    </span>return `<span class="s1">每週</span> (${budget.resetDay} <span class="s1">重設</span>)`;</p>
<p class="p1"><span class="Apple-converted-space">                </span>case 'monthly':</p>
<p class="p1"><span class="Apple-converted-space">                    </span>return `<span class="s1">每月</span> (${budget.resetDay}<span class="s1">日</span> <span class="s1">重設</span>)`;</p>
<p class="p1"><span class="Apple-converted-space">                </span>default:</p>
<p class="p1"><span class="Apple-converted-space">                    </span>return '<span class="s1">未設定</span>';</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>function getBudgetUsed() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (!budget.lastReset) return 0;</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>const lastReset = new Date(budget.lastReset);</p>
<p class="p1"><span class="Apple-converted-space">            </span>return transactions</p>
<p class="p1"><span class="Apple-converted-space">                </span>.filter(t =&gt; t.type === 'expense' &amp;&amp; new Date(t.date) &gt;= lastReset)</p>
<p class="p1"><span class="Apple-converted-space">                </span>.reduce((sum, t) =&gt; sum + parseFloat(t.amount), 0);</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>function getBudgetRemaining() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>return budget.amount - getBudgetUsed();</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>function getBudgetPercentage() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (!budget.amount) return 0;</p>
<p class="p1"><span class="Apple-converted-space">            </span>return Math.round((getBudgetUsed() / budget.amount) * 100);</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;/script&gt;</p>
<p class="p1">&lt;/body&gt;</p>
<p class="p1">&lt;/html&gt;</p>
</body>
</html>
