<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é€²éšå€‹äººè²¡å‹™è¿½è¹¤å™¨</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="header">
        <div class="container header-content">
            <div class="logo">
                ğŸ’° <span>é€²éšå€‹äººè²¡å‹™è¿½è¹¤å™¨</span>
            </div>
            <div class="user-status">
                <div id="login-status">æœªç™»å…¥</div>
                <button id="settings-btn" class="btn">âš™ï¸ è¨­å®š</button>
            </div>
        </div>
    </div>

    <div class="container">
        <div class="dashboard">
            <div class="card">
                <div class="card-header">
                    <div class="card-title">ç¸½è³‡ç”¢</div>
                </div>
                <div class="card-body">
                    <h2 id="total-assets">$ 0.00</h2>
                </div>
            </div>
            <div class="card">
                <div class="card-header">
                    <div class="card-title">ä»Šæ—¥æ”¶å…¥</div>
                </div>
                <div class="card-body">
                    <h2 id="today-income" class="positive">$ 0.00</h2>
                </div>
            </div>
            <div class="card">
                <div class="card-header">
                    <div class="card-title">ä»Šæ—¥æ”¯å‡º</div>
                </div>
                <div class="card-body">
                    <h2 id="today-expense" class="negative">$ 0.00</h2>
                </div>
            </div>
        </div>

        <div class="tabs">
            <div class="tab active" data-tab="dashboard">ğŸ“Š å„€è¡¨æ¿</div>
            <div class="tab" data-tab="accounts">ğŸ’³ æˆ¶å£ç®¡ç†</div>
            <div class="tab" data-tab="transactions">ğŸ“ è¨˜è³¬</div>
            <div class="tab" data-tab="budgets">âš™ï¸ é ç®—è¨­å®š</div>
            <div class="tab" data-tab="categories">ğŸ·ï¸ é¡åˆ¥ç®¡ç†</div>
            <div class="tab" data-tab="statistics">ğŸ“ˆ çµ±è¨ˆåˆ†æ</div>
            <div class="tab" data-tab="sync">ğŸ”„ åŒæ­¥</div>
        </div>

        <!-- å„€è¡¨æ¿ -->
        <div id="dashboard" class="tab-content active">
            <div class="row">
                <div class="col">
                    <div class="card">
                        <div class="card-header">
                            <div class="card-title">ğŸ“… ä»Šæ—¥äº¤æ˜“</div>
                        </div>
                        <div class="card-body">
                            <div id="today-transactions" class="transaction-list">
                                <div class="empty-state">ä»Šæ—¥å°šç„¡äº¤æ˜“è¨˜éŒ„</div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col">
                    <div class="card">
                        <div class="card-header">
                            <div class="card-title">ğŸ“Š é ç®—ç‹€æ…‹</div>
                        </div>
                        <div class="card-body">
                            <div id="budget-status">
                                <div class="empty-state">å°šæœªè¨­å®šé ç®—</div>
                                <button id="setup-budget-btn" class="btn btn-primary">è¨­å®šé ç®—</button>
                            </div>
                        </div>
                    </div>
                    <div class="card">
                        <div class="card-header">
                            <div class="card-title">ğŸ•’ è¿‘æœŸäº¤æ˜“</div>
                            <a href="#" id="view-all-transactions" class="link">æŸ¥çœ‹å…¨éƒ¨äº¤æ˜“</a>
                        </div>
                        <div class="card-body">
                            <div id="recent-transactions" class="transaction-list">
                                <div class="empty-state">å°šç„¡äº¤æ˜“è¨˜éŒ„</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- æˆ¶å£ç®¡ç† -->
        <div id="accounts" class="tab-content">
            <div class="action-bar">
                <button id="add-account-btn" class="btn btn-primary">+ æ–°å¢æˆ¶å£</button>
            </div>
            <div class="card">
                <div class="card-header">
                    <div class="card-title">æˆ‘çš„æˆ¶å£</div>
                </div>
                <div class="card-body">
                    <div id="accounts-list">
                        <div class="empty-state">å°šæœªè¨­ç½®ä»»ä½•æˆ¶å£</div>
                    </div>
                </div>
            </div>
            <div class="card">
                <div class="card-header">
                    <div class="card-title">ğŸ”„ è½‰è³¬</div>
                </div>
                <div class="card-body">
                    <form id="transfer-form">
                        <div class="form-group">
                            <label for="from-account">å¾æˆ¶å£</label>
                            <select id="from-account" required>
                                <option value="">é¸æ“‡æˆ¶å£</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="to-account">è‡³æˆ¶å£</label>
                            <select id="to-account" required>
                                <option value="">é¸æ“‡æˆ¶å£</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="transfer-amount">é‡‘é¡</label>
                            <div class="currency-input">
                                <input type="number" id="transfer-amount" min="0" step="0.01" required>
                            </div>
                        </div>
                        <button type="submit" class="btn btn-primary">ç¢ºèªè½‰è³¬</button>
                    </form>
                </div>
            </div>
        </div>

        <!-- è¨˜è³¬ -->
        <div id="transactions" class="tab-content">
            <div class="card">
                <div class="card-header">
                    <div class="card-title">ğŸ“ è¨˜éŒ„æ”¶å…¥/æ”¯å‡º</div>
                </div>
                <div class="card-body">
                    <div class="tabs transaction-tabs">
                        <div class="tab active" data-tab="income">ğŸ’¹ æ”¶å…¥</div>
                        <div class="tab" data-tab="expense">ğŸ’¸ æ”¯å‡º</div>
                    </div>
                    <form id="transaction-form">
                        <input type="hidden" id="transaction-type" value="income">
                        <div class="form-group">
                            <label for="transaction-account">é¸æ“‡æˆ¶å£</label>
                            <select id="transaction-account" required>
                                <option value="">é¸æ“‡æˆ¶å£</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="transaction-category">é¸æ“‡é¡åˆ¥</label>
                            <select id="transaction-category" required>
                                <option value="">é¸æ“‡é¡åˆ¥</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="transaction-amount">é‡‘é¡</label>
                            <div class="currency-input">
                                <input type="number" id="transaction-amount" min="0" step="0.01" required>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="transaction-date">æ—¥æœŸ</label>
                            <input type="date" id="transaction-date" required>
                        </div>
                        <div class="form-group">
                            <label for="transaction-notes">å‚™è¨» (å¯é¸)</label>
                            <textarea id="transaction-notes"></textarea>
                        </div>
                        <button type="submit" class="btn btn-primary">âœ… ä¿å­˜</button>
                    </form>
                </div>
            </div>
            <div class="card">
                <div class="card-header">
                    <div class="card-title">ğŸ“‹ äº¤æ˜“è¨˜éŒ„</div>
                </div>
                <div class="card-body">
                    <div class="filter-bar">
                        <div class="form-group">
                            <label for="filter-date-from">æ—¥æœŸç¯„åœ</label>
                            <div class="date-range">
                                <input type="date" id="filter-date-from">
                                <span>è‡³</span>
                                <input type="date" id="filter-date-to">
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="filter-type">é¡å‹</label>
                            <select id="filter-type">
                                <option value="all">å…¨éƒ¨</option>
                                <option value="income">æ”¶å…¥</option>
                                <option value="expense">æ”¯å‡º</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="filter-category">é¡åˆ¥</label>
                            <select id="filter-category">
                                <option value="all">å…¨éƒ¨é¡åˆ¥</option>
                            </select>
                        </div>
                        <button id="filter-submit" class="btn btn-primary">ğŸ” æœå°‹</button>
                    </div>
                    <div id="transactions-list" class="transaction-list">
                        <div class="empty-state">ç„¡ç¬¦åˆæ¢ä»¶çš„äº¤æ˜“è¨˜éŒ„</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- é ç®—è¨­å®š -->
        <div id="budgets" class="tab-content">
            <div class="card">
                <div class="card-header">
                    <div class="card-title">âš™ï¸ ç¸½é ç®—è¨­å®š</div>
                </div>
                <div class="card-body">
                    <form id="main-budget-form">
                        <div class="form-group">
                            <label for="budget-amount">é ç®—é‡‘é¡</label>
                            <div class="currency-input">
                                <input type="number" id="budget-amount" min="0" step="0.01" required>
                            </div>
                            <div class="checkbox-group">
                                <input type="checkbox" id="auto-calculate">
                                <label for="auto-calculate">è‡ªå‹•è¨ˆç®— (é¡åˆ¥é ç®—ç¸½å’Œ)</label>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>é‡è¨­é€±æœŸ</label>
                            <div class="radio-group">
                                <div class="radio-item">
                                    <input type="radio" id="cycle-daily" name="budget-cycle" value="daily">
                                    <label for="cycle-daily">æ¯æ—¥</label>
                                </div>
                                <div class="radio-item">
                                    <input type="radio" id="cycle-weekly" name="budget-cycle" value="weekly">
                                    <label for="cycle-weekly">æ¯é€±</label>
                                </div>
                                <div class="radio-item">
                                    <input type="radio" id="cycle-monthly" name="budget-cycle" value="monthly" checked>
                                    <label for="cycle-monthly">æ¯æœˆ</label>
                                </div>
                            </div>
                        </div>
                        <button type="submit" class="btn btn-primary">âœ… ä¿å­˜è¨­å®š</button>
                    </form>
                </div>
            </div>
            <div class="card">
                <div class="card-header">
                    <div class="card-title">ğŸ“Š é¡åˆ¥é ç®—è¨­å®š</div>
                </div>
                <div class="card-body">
                    <div class="form-group">
                        <label for="budget-category">é¸æ“‡é¡åˆ¥</label>
                        <div class="input-with-button">
                            <select id="budget-category">
                                <option value="">é¸æ“‡é¡åˆ¥</option>
                            </select>
                            <button id="add-category-budget" class="btn">æ·»åŠ </button>
                        </div>
                    </div>
                    <div id="category-budgets">
                        <div class="empty-state">å°šæœªè¨­ç½®é¡åˆ¥é ç®—</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- é¡åˆ¥ç®¡ç† -->
        <div id="categories" class="tab-content">
            <div class="tabs category-tabs">
                <div class="tab active" data-tab="income-categories">ğŸ’¹ æ”¶å…¥é¡åˆ¥</div>
                <div class="tab" data-tab="expense-categories">ğŸ’¸ æ”¯å‡ºé¡åˆ¥</div>
            </div>
            <div class="action-bar">
                <button id="add-category-btn" class="btn btn-primary">+ æ–°å¢</button>
            </div>
            <div id="income-categories" class="category-content active">
                <div id="income-categories-list" class="categories-list">
                    <div class="empty-state">å°šæœªè¨­ç½®æ”¶å…¥é¡åˆ¥</div>
                </div>
            </div>
            <div id="expense-categories" class="category-content">
                <div id="expense-categories-list" class="categories-list">
                    <div class="empty-state">å°šæœªè¨­ç½®æ”¯å‡ºé¡åˆ¥</div>
                </div>
            </div>
        </div>

        <!-- çµ±è¨ˆåˆ†æ -->
        <div id="statistics" class="tab-content">
            <div class="card">
                <div class="card-header">
                    <div class="card-title">ğŸ“ˆ æ¯æœˆæ”¶æ”¯çµ±è¨ˆ</div>
                </div>
                <div class="card-body">
                    <div class="chart-container">
                        <canvas id="monthly-chart"></canvas>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col">
                    <div class="card">
                        <div class="card-header">
                            <div class="card-title">æ”¶å…¥åˆ†ä½ˆ</div>
                        </div>
                        <div class="card-body">
                            <div class="chart-container">
                                <canvas id="income-pie-chart"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col">
                    <div class="card">
                        <div class="card-header">
                            <div class="card-title">æ”¯å‡ºåˆ†ä½ˆ</div>
                        </div>
                        <div class="card-body">
                            <div class="chart-container">
                                <canvas id="expense-pie-chart"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- åŒæ­¥é é¢ -->
        <div id="sync" class="tab-content">
            <div class="card">
                <div class="card-header">
                    <div class="card-title">ğŸ”„ æ•¸æ“šåŒæ­¥</div>
                </div>
                <div class="card-body">
                    <div class="sync-status">
                        <div id="firebase-login-status" class="status-box">
                            <h3>åŒæ­¥ç‹€æ…‹</h3>
                            <p id="sync-status-message">æœªç™»å…¥</p>
                        </div>
                        <div class="login-buttons">
                            <button id="firebase-login-btn" class="btn btn-primary">ä½¿ç”¨Googleå¸³æˆ¶ç™»å…¥</button>
                            <button id="firebase-logout-btn" class="btn btn-danger" style="display:none">ç™»å‡º</button>
                        </div>
                    </div>
                    <div class="last-sync-info">
                        <p>ä¸Šæ¬¡åŒæ­¥æ™‚é–“: <span id="last-sync-time">å¾æœªåŒæ­¥</span></p>
                    </div>
                    <div class="sync-controls">
                        <button id="manual-sync" class="btn btn-primary" disabled>ç«‹å³åŒæ­¥</button>
                        <div class="form-group">
                            <div class="checkbox-group">
                                <input type="checkbox" id="auto-sync" disabled>
                                <label for="auto-sync">å•Ÿç”¨è‡ªå‹•åŒæ­¥ (æ¯æ¬¡æ•¸æ“šè®Šæ›´æ™‚)</label>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="card">
                <div class="card-header">
                    <div class="card-title">ğŸ’¾ æ•¸æ“šå‚™ä»½èˆ‡é‚„åŸ</div>
                </div>
                <div class="card-body">
                    <div class="backup-controls">
                        <button id="export-data" class="btn">åŒ¯å‡ºæ•¸æ“š</button>
                        <button id="download-data" class="btn">ä¸‹è¼‰ç‚ºæ–‡ä»¶</button>
                    </div>
                    <div class="restore-controls">
                        <div class="form-group">
                            <label for="import-file">å¾æ–‡ä»¶ä¸Šå‚³</label>
                            <input type="file" id="import-file" accept=".json">
                        </div>
                        <div class="form-group">
                            <label for="import-text">æˆ–è²¼ä¸Šä¹‹å‰åŒ¯å‡ºçš„æ•¸æ“š:</label>
                            <textarea id="import-text" rows="5"></textarea>
                        </div>
                        <button id="import-data" class="btn btn-warning">åŒ¯å…¥æ•¸æ“š</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- æ¨¡æ…‹æ¡† -->
    <div id="modal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <div id="modal-content"></div>
        </div>
    </div>

    <!-- Firebase SDK -->
    <script type="module">
        // Import the functions you need from the SDKs
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.5.0/firebase-app.js";
        import { getDatabase } from "https://www.gstatic.com/firebasejs/10.5.0/firebase-database.js";
        import { getAuth } from "https://www.gstatic.com/firebasejs/10.5.0/firebase-auth.js";

        // æ›´æ–°é€™éƒ¨åˆ†å°å…¥ï¼Œæ·»åŠ å¿…è¦çš„å‡½æ•¸
        import { GoogleAuthProvider, signInWithPopup } from "https://www.gstatic.com/firebasejs/10.5.0/firebase-auth.js";
        import { ref, set, get, onValue } from "https://www.gstatic.com/firebasejs/10.5.0/firebase-database.js";

        // æ‚¨éœ€è¦å¾Firebaseæ§åˆ¶å°ç²å–é€™äº›é…ç½®ä¿¡æ¯
        const firebaseConfig = {
            apiKey: "AIzaSyAaqadmDSgQ-huvY7uNNrPtjFSOl93jVEE",
            authDomain: "finance-d8f9e.firebaseapp.com",
            projectId: "finance-d8f9e",
            storageBucket: "finance-d8f9e.firebasestorage.app",
            messagingSenderId: "122645255279",
            appId: "1:122645255279:web:25d577b6365c819ffbe99a",
            measurementId: "G-ZCGNG1DRJS"
        };

        // åˆå§‹åŒ–Firebase
        const app = initializeApp(firebaseConfig);
        const db = getDatabase(app);
        const auth = getAuth(app);
        
        // å°‡Firebaseç‰©ä»¶è¨­ç‚ºå…¨åŸŸï¼Œä»¥ä¾¿åœ¨script.jsä¸­ä½¿ç”¨
        window.firebaseApp = app;
        window.firebaseDb = db;
        window.firebaseAuth = auth;
        window.firebase = {
            auth: {
                GoogleAuthProvider,
                signInWithPopup
            },
            database: {
                ref,
                set,
                get,
                onValue
            }
        };
    </script>
    
    <!-- å¼•å…¥ Chart.js ç”¨æ–¼æ•¸æ“šå¯è¦–åŒ– -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- è‡ªè¨‚è…³æœ¬ -->
    <script src="script.js"></script>
</body>
</html>
